

============================== 2022-10-20 15:29:17.460904 | b80e91a0-9bae-4cc2-97a5-7c506ac9558a ==============================
15:29:17.460922 [info ] [MainThread]: Running with dbt=1.1.1
15:29:17.461302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
15:29:17.461423 [debug] [MainThread]: Tracking: tracking
15:29:17.469079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3e6e0>]}
15:29:17.485722 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
15:29:17.485963 [debug] [MainThread]: Partial parsing: added file: dbt_practice://seeds/mapping/months.csv
15:29:17.486053 [debug] [MainThread]: Partial parsing: added file: dbt_practice://macros/get_custom_schema.sql
15:29:17.486127 [debug] [MainThread]: Partial parsing: added file: dbt_practice://models/staging/stg_transactions_totals.sql
15:29:17.486242 [debug] [MainThread]: Partial parsing: added file: dbt_practice://models/raw_data/transactions.yml
15:29:17.486370 [debug] [MainThread]: Partial parsing: deleted file: dbt_practice://models/example/my_first_dbt_model.sql
15:29:17.486421 [debug] [MainThread]: Partial parsing: deleted file: dbt_practice://models/testing/my_third_dbt_model.sql
15:29:17.486467 [debug] [MainThread]: Partial parsing: deleted file: dbt_practice://models/example/my_second_dbt_model.sql
15:29:17.486534 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
15:29:17.488335 [info ] [MainThread]: Change detected to override macro used during parsing. Starting full parse.
15:29:17.488455 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
15:29:17.489205 [debug] [MainThread]: Parsing macros/etc.sql
15:29:17.489967 [debug] [MainThread]: Parsing macros/catalog.sql
15:29:17.493016 [debug] [MainThread]: Parsing macros/adapters.sql
15:29:17.504233 [debug] [MainThread]: Parsing macros/materializations/seed.sql
15:29:17.505354 [debug] [MainThread]: Parsing macros/materializations/view.sql
15:29:17.506405 [debug] [MainThread]: Parsing macros/materializations/table.sql
15:29:17.508043 [debug] [MainThread]: Parsing macros/materializations/copy.sql
15:29:17.509119 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
15:29:17.515591 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
15:29:17.516260 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
15:29:17.517826 [debug] [MainThread]: Parsing macros/materializations/configs.sql
15:29:17.518743 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:29:17.519423 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:29:17.526584 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
15:29:17.532441 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:29:17.537324 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:29:17.539178 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:29:17.539906 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
15:29:17.540621 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
15:29:17.542441 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:29:17.550016 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
15:29:17.550637 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
15:29:17.555005 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
15:29:17.561950 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
15:29:17.565294 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:29:17.566444 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
15:29:17.569684 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
15:29:17.570199 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
15:29:17.571325 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:29:17.572227 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
15:29:17.574815 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:29:17.582112 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
15:29:17.582709 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
15:29:17.583718 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
15:29:17.584352 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
15:29:17.584717 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
15:29:17.585036 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
15:29:17.585316 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
15:29:17.585865 [debug] [MainThread]: Parsing macros/etc/statement.sql
15:29:17.587700 [debug] [MainThread]: Parsing macros/etc/datetime.sql
15:29:17.591346 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:29:17.592201 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:29:17.593277 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:29:17.597298 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:29:17.598475 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:29:17.600269 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:29:17.603429 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:29:17.607501 [debug] [MainThread]: Parsing tests/generic/builtin.sql
15:29:17.709677 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
15:29:17.737272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

15:29:17.739553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b80e91a0-9bae-4cc2-97a5-7c506ac9558a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110919720>]}
15:29:17.742419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b80e91a0-9bae-4cc2-97a5-7c506ac9558a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083ead0>]}
15:29:17.742543 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
15:29:17.742649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b80e91a0-9bae-4cc2-97a5-7c506ac9558a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083ec50>]}
15:29:17.743175 [info ] [MainThread]: 
15:29:17.743351 [debug] [MainThread]: Acquiring new bigquery connection "master"
15:29:17.743645 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_staging"
15:29:17.743789 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_mapping"
15:29:17.743876 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:29:17.743939 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:29:17.744033 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
15:29:17.744097 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
15:29:17.744462 [debug] [MainThread]: Connection 'master' was properly closed.
15:29:17.744518 [debug] [MainThread]: Connection 'list_dbt-practice-355719_staging' was properly closed.
15:29:17.744563 [debug] [MainThread]: Connection 'list_dbt-practice-355719_mapping' was properly closed.
15:29:17.744691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083d540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11083d510>]}


============================== 2022-10-20 20:40:03.788649 | 1b67d335-1df2-416d-bcff-8a7c36827f1d ==============================
20:40:03.788664 [info ] [MainThread]: Running with dbt=1.1.1
20:40:03.789238 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:40:03.789425 [debug] [MainThread]: Tracking: tracking
20:40:03.797998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b11fac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b11f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b11e770>]}
20:40:03.816210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:40:03.816355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:40:03.816539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

20:40:03.819510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b67d335-1df2-416d-bcff-8a7c36827f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2795a0>]}
20:40:03.821845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b67d335-1df2-416d-bcff-8a7c36827f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1f5480>]}
20:40:03.821956 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:40:03.822061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b67d335-1df2-416d-bcff-8a7c36827f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1f55a0>]}
20:40:03.822649 [info ] [MainThread]: 
20:40:03.822827 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:40:03.823141 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_mapping"
20:40:03.823284 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_staging"
20:40:03.823383 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:40:03.823450 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:40:03.823588 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
20:40:03.823644 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
20:40:03.824084 [debug] [MainThread]: Connection 'master' was properly closed.
20:40:03.824145 [debug] [MainThread]: Connection 'list_dbt-practice-355719_mapping' was properly closed.
20:40:03.824190 [debug] [MainThread]: Connection 'list_dbt-practice-355719_staging' was properly closed.
20:40:03.824340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1f4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1f47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1f48b0>]}


============================== 2022-10-20 20:42:06.258360 | 80895876-d357-4c50-8b2a-7c1e0d610db7 ==============================
20:42:06.258386 [info ] [MainThread]: Running with dbt=1.1.1
20:42:06.258692 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:42:06.258796 [debug] [MainThread]: Tracking: tracking
20:42:06.266615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3afe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e38f70>]}
20:42:06.275201 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
20:42:06.275372 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:42:06.275544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80895876-d357-4c50-8b2a-7c1e0d610db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3b280>]}
20:42:06.282723 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
20:42:06.283807 [debug] [MainThread]: Parsing macros/etc.sql
20:42:06.284615 [debug] [MainThread]: Parsing macros/catalog.sql
20:42:06.287741 [debug] [MainThread]: Parsing macros/adapters.sql
20:42:06.298399 [debug] [MainThread]: Parsing macros/materializations/seed.sql
20:42:06.299445 [debug] [MainThread]: Parsing macros/materializations/view.sql
20:42:06.300498 [debug] [MainThread]: Parsing macros/materializations/table.sql
20:42:06.302358 [debug] [MainThread]: Parsing macros/materializations/copy.sql
20:42:06.303437 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
20:42:06.309917 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
20:42:06.310579 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:42:06.312134 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:42:06.313048 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:42:06.313738 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:42:06.320908 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:42:06.326837 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:42:06.331877 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:42:06.333743 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:42:06.334472 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:42:06.335192 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:42:06.337002 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:42:06.344721 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:42:06.345339 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:42:06.349755 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:42:06.356706 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:42:06.360187 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:42:06.361333 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:42:06.364655 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:42:06.365168 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:42:06.366285 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:42:06.367195 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:42:06.369796 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:42:06.377144 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:42:06.377741 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:42:06.378752 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:42:06.379387 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:42:06.379753 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:42:06.380077 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:42:06.380348 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:42:06.380900 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:42:06.382711 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:42:06.386335 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:42:06.387191 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:42:06.388280 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:42:06.392322 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:42:06.393494 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:42:06.395297 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:42:06.398373 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:42:06.402445 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:42:06.505640 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
20:42:06.530172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

20:42:06.532474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80895876-d357-4c50-8b2a-7c1e0d610db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f77cd0>]}
20:42:06.534587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80895876-d357-4c50-8b2a-7c1e0d610db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f77670>]}
20:42:06.534696 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:42:06.534796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80895876-d357-4c50-8b2a-7c1e0d610db7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e8730>]}
20:42:06.535296 [info ] [MainThread]: 
20:42:06.535460 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:42:06.535753 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_mapping"
20:42:06.535897 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_staging"
20:42:06.535983 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:42:06.536054 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:42:06.536144 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-accounttt''
20:42:06.536211 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-accounttt''
20:42:06.536572 [debug] [MainThread]: Connection 'master' was properly closed.
20:42:06.536630 [debug] [MainThread]: Connection 'list_dbt-practice-355719_mapping' was properly closed.
20:42:06.536675 [debug] [MainThread]: Connection 'list_dbt-practice-355719_staging' was properly closed.
20:42:06.536801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f77d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f76e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f74b50>]}


============================== 2022-10-20 20:42:21.718195 | c1de2469-c771-40d5-b2c5-1f9f4d97f40d ==============================
20:42:21.718213 [info ] [MainThread]: Running with dbt=1.1.1
20:42:21.718510 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'prod', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:42:21.718631 [debug] [MainThread]: Tracking: tracking
20:42:21.726803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ba890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069bb670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069ba770>]}
20:42:21.735282 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
20:42:21.735444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1de2469-c771-40d5-b2c5-1f9f4d97f40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b9de0>]}
20:42:21.741633 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
20:42:21.742694 [debug] [MainThread]: Parsing macros/etc.sql
20:42:21.743495 [debug] [MainThread]: Parsing macros/catalog.sql
20:42:21.746634 [debug] [MainThread]: Parsing macros/adapters.sql
20:42:21.757311 [debug] [MainThread]: Parsing macros/materializations/seed.sql
20:42:21.758394 [debug] [MainThread]: Parsing macros/materializations/view.sql
20:42:21.759457 [debug] [MainThread]: Parsing macros/materializations/table.sql
20:42:21.761325 [debug] [MainThread]: Parsing macros/materializations/copy.sql
20:42:21.762418 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
20:42:21.768945 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
20:42:21.769622 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:42:21.771206 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:42:21.772136 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:42:21.772826 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:42:21.780068 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:42:21.786028 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:42:21.791100 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:42:21.792980 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:42:21.793723 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:42:21.794450 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:42:21.796281 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:42:21.804005 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:42:21.804626 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:42:21.809104 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:42:21.816092 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:42:21.819614 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:42:21.820787 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:42:21.824150 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:42:21.824672 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:42:21.825801 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:42:21.826720 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:42:21.829331 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:42:21.836781 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:42:21.837450 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:42:21.838496 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:42:21.839137 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:42:21.839510 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:42:21.839833 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:42:21.840109 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:42:21.840665 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:42:21.842506 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:42:21.846187 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:42:21.847048 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:42:21.848116 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:42:21.852165 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:42:21.853348 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:42:21.855155 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:42:21.858243 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:42:21.862347 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:42:21.964744 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
20:42:21.990639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

20:42:21.993212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1de2469-c771-40d5-b2c5-1f9f4d97f40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b01f90>]}
20:42:21.995447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1de2469-c771-40d5-b2c5-1f9f4d97f40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b00550>]}
20:42:21.995558 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:42:21.995660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1de2469-c771-40d5-b2c5-1f9f4d97f40d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a0580>]}
20:42:21.996161 [info ] [MainThread]: 
20:42:21.996339 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:42:21.996620 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_staging"
20:42:21.996684 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:42:21.996861 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_mapping"
20:42:21.996925 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:42:21.996995 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
20:42:21.997129 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
20:42:21.997416 [debug] [MainThread]: Connection 'master' was properly closed.
20:42:21.997466 [debug] [MainThread]: Connection 'list_dbt-practice-355719_staging' was properly closed.
20:42:21.997511 [debug] [MainThread]: Connection 'list_dbt-practice-355719_mapping' was properly closed.
20:42:21.997640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b00d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b011e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b004c0>]}


============================== 2022-10-20 20:46:42.209984 | 5c69df5c-645b-4347-a563-ddb2a2badc29 ==============================
20:46:42.210000 [info ] [MainThread]: Running with dbt=1.1.1
20:46:42.210439 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:46:42.210746 [debug] [MainThread]: Tracking: tracking
20:46:42.220665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a6770>]}
20:46:42.230414 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
20:46:42.230604 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:46:42.230706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5c69df5c-645b-4347-a563-ddb2a2badc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a71f0>]}
20:46:42.239622 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
20:46:42.240686 [debug] [MainThread]: Parsing macros/etc.sql
20:46:42.241499 [debug] [MainThread]: Parsing macros/catalog.sql
20:46:42.244597 [debug] [MainThread]: Parsing macros/adapters.sql
20:46:42.255751 [debug] [MainThread]: Parsing macros/materializations/seed.sql
20:46:42.256877 [debug] [MainThread]: Parsing macros/materializations/view.sql
20:46:42.257950 [debug] [MainThread]: Parsing macros/materializations/table.sql
20:46:42.259829 [debug] [MainThread]: Parsing macros/materializations/copy.sql
20:46:42.260908 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
20:46:42.267373 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
20:46:42.268038 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:46:42.269612 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:46:42.270540 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:46:42.271232 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:46:42.278441 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:46:42.284349 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:46:42.289375 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:46:42.291237 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:46:42.291961 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:46:42.292676 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:46:42.294482 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:46:42.302099 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:46:42.302716 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:46:42.307140 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:46:42.314160 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:46:42.317642 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:46:42.318794 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:46:42.322127 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:46:42.322634 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:46:42.323759 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:46:42.324669 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:46:42.327263 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:46:42.334592 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:46:42.335190 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:46:42.336201 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:46:42.336823 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:46:42.337186 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:46:42.337516 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:46:42.337787 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:46:42.338339 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:46:42.340151 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:46:42.343785 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:46:42.344636 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:46:42.345707 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:46:42.349730 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:46:42.350894 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:46:42.352685 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:46:42.355743 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:46:42.359848 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:46:42.463103 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
20:46:42.487761 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

20:46:42.490094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c69df5c-645b-4347-a563-ddb2a2badc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ef160>]}
20:46:42.492221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c69df5c-645b-4347-a563-ddb2a2badc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878f220>]}
20:46:42.492329 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:46:42.492425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c69df5c-645b-4347-a563-ddb2a2badc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a7040>]}
20:46:42.492930 [info ] [MainThread]: 
20:46:42.493102 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:46:42.493408 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_staging"
20:46:42.493556 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_mapping"
20:46:42.493644 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:46:42.493716 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:46:42.718262 [debug] [MainThread]: Connection 'master' was properly closed.
20:46:42.718439 [debug] [MainThread]: Connection 'list_dbt-practice-355719_staging' was properly closed.
20:46:42.718522 [debug] [MainThread]: Connection 'list_dbt-practice-355719_mapping' was properly closed.
20:46:42.718659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ee1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ecb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088eef20>]}


============================== 2022-10-20 20:53:02.561293 | a5b232d4-e0ed-422d-ad63-7546d445366a ==============================
20:53:02.561329 [info ] [MainThread]: Running with dbt=1.1.1
20:53:02.561865 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:53:02.562074 [debug] [MainThread]: Tracking: tracking
20:53:02.569532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf9330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfa770>]}
20:53:02.578814 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:53:02.578992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5b232d4-e0ed-422d-ad63-7546d445366a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf9d20>]}
20:53:02.587292 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
20:53:02.588325 [debug] [MainThread]: Parsing macros/etc.sql
20:53:02.589143 [debug] [MainThread]: Parsing macros/catalog.sql
20:53:02.592275 [debug] [MainThread]: Parsing macros/adapters.sql
20:53:02.602839 [debug] [MainThread]: Parsing macros/materializations/seed.sql
20:53:02.603871 [debug] [MainThread]: Parsing macros/materializations/view.sql
20:53:02.604935 [debug] [MainThread]: Parsing macros/materializations/table.sql
20:53:02.606786 [debug] [MainThread]: Parsing macros/materializations/copy.sql
20:53:02.607872 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
20:53:02.614321 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
20:53:02.614983 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:53:02.616551 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:53:02.617467 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:53:02.618153 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:53:02.625329 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:53:02.631241 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:53:02.636274 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:53:02.638133 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:53:02.638860 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:53:02.639574 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:53:02.641385 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:53:02.649067 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:53:02.649684 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:53:02.654113 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:53:02.661068 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:53:02.664575 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:53:02.665734 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:53:02.669056 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:53:02.669569 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:53:02.670688 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:53:02.671594 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:53:02.674164 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:53:02.681504 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:53:02.682102 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:53:02.683109 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:53:02.683742 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:53:02.684115 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:53:02.684428 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:53:02.684701 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:53:02.685253 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:53:02.687078 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:53:02.690733 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:53:02.691586 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:53:02.692659 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:53:02.696716 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:53:02.697894 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:53:02.699690 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:53:02.702774 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:53:02.706866 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:53:02.809775 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
20:53:02.834608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

20:53:02.836933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b232d4-e0ed-422d-ad63-7546d445366a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e41630>]}
20:53:02.839036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5b232d4-e0ed-422d-ad63-7546d445366a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e42650>]}
20:53:02.839141 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:53:02.839240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b232d4-e0ed-422d-ad63-7546d445366a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ced450>]}
20:53:02.839743 [info ] [MainThread]: 
20:53:02.839921 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:53:02.840200 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_staging"
20:53:02.840366 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_mapping"
20:53:02.840466 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:53:02.840538 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:53:03.403239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b232d4-e0ed-422d-ad63-7546d445366a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e42ef0>]}
20:53:03.404750 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
20:53:03.405354 [info ] [MainThread]: 
20:53:03.412884 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
20:53:03.413099 [debug] [Thread-2 (]: Began running node seed.dbt_practice.months
20:53:03.413560 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
20:53:03.413838 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.dbt_practice.months"
20:53:03.413990 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
20:53:03.414122 [debug] [Thread-2 (]: Began compiling node seed.dbt_practice.months
20:53:03.414281 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
20:53:03.414400 [debug] [Thread-2 (]: Compiling seed.dbt_practice.months
20:53:03.417594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
20:53:03.418884 [debug] [Thread-2 (]: Writing injected SQL for node "seed.dbt_practice.months"
20:53:03.419158 [debug] [Thread-2 (]: finished collecting timing info
20:53:03.419315 [debug] [Thread-2 (]: Began executing node seed.dbt_practice.months
20:53:03.419460 [debug] [Thread-2 (]: finished collecting timing info
20:53:03.419840 [debug] [Thread-2 (]: Finished running node seed.dbt_practice.months
20:53:03.420580 [debug] [Thread-1 (]: finished collecting timing info
20:53:03.420699 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
20:53:03.420805 [debug] [Thread-1 (]: finished collecting timing info
20:53:03.421092 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
20:53:03.421875 [debug] [MainThread]: Connection 'master' was properly closed.
20:53:03.421991 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
20:53:03.422088 [debug] [MainThread]: Connection 'seed.dbt_practice.months' was properly closed.
20:53:03.426706 [info ] [MainThread]: Done.
20:53:03.429012 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
20:53:03.429157 [info ] [MainThread]: Building catalog
20:53:03.429692 [debug] [MainThread]: Opening a new connection, currently in state init
20:53:03.970905 [debug] [MainThread]: BigQuery adapter: Skipping catalog for dbt-practice-355719.mapping - schema does not exist
20:53:03.973235 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-355719.information_schema"
20:53:03.973813 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-355719.information_schema"
20:53:03.991193 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:53:03.993915 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:53:03.995254 [debug] [ThreadPool]: On dbt-practice-355719.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-355719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-355719`.`raw_data`.__TABLES__
        where (upper(dataset_id) = upper('raw_data'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
20:53:03.996167 [debug] [ThreadPool]: On dbt-practice-355719.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-355719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-355719`.`staging`.__TABLES__
        where (upper(dataset_id) = upper('staging'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-355719`.`staging`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-355719`.`staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
20:53:07.053175 [info ] [MainThread]: Catalog written to /Users/will/Projects/dbt-practice/target/catalog.json
20:53:07.053665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf9330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d75a20>]}
20:53:07.290130 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
20:53:07.290511 [debug] [MainThread]: Connection 'dbt-practice-355719.information_schema' was properly closed.
20:53:07.290670 [debug] [MainThread]: Connection 'dbt-practice-355719.information_schema' was properly closed.


============================== 2022-10-20 20:54:21.470028 | f8141227-5cd6-4d60-b7ae-a72889f3749f ==============================
20:54:21.470049 [info ] [MainThread]: Running with dbt=1.1.1
20:54:21.470369 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
20:54:21.470461 [debug] [MainThread]: Tracking: tracking
20:54:21.477619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ffe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ff970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ffe50>]}
20:54:21.492399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:54:21.492525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:54:21.492700 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

20:54:21.495222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8141227-5cd6-4d60-b7ae-a72889f3749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108559870>]}
20:54:21.497762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8141227-5cd6-4d60-b7ae-a72889f3749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d5360>]}
20:54:21.497881 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:54:21.497978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8141227-5cd6-4d60-b7ae-a72889f3749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840b910>]}
20:54:21.498565 [info ] [MainThread]: 
20:54:21.498900 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:54:21.499257 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_staging"
20:54:21.499442 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_mapping"
20:54:21.499507 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:54:21.499615 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:54:21.993248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8141227-5cd6-4d60-b7ae-a72889f3749f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084d4430>]}
20:54:21.994785 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
20:54:21.995239 [info ] [MainThread]: 
20:54:21.999639 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
20:54:21.999814 [debug] [Thread-2 (]: Began running node seed.dbt_practice.months
20:54:22.000196 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
20:54:22.000480 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.dbt_practice.months"
20:54:22.000635 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
20:54:22.000764 [debug] [Thread-2 (]: Began compiling node seed.dbt_practice.months
20:54:22.000934 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
20:54:22.001052 [debug] [Thread-2 (]: Compiling seed.dbt_practice.months
20:54:22.004384 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
20:54:22.005430 [debug] [Thread-2 (]: Writing injected SQL for node "seed.dbt_practice.months"
20:54:22.005669 [debug] [Thread-2 (]: finished collecting timing info
20:54:22.005799 [debug] [Thread-2 (]: Began executing node seed.dbt_practice.months
20:54:22.005934 [debug] [Thread-2 (]: finished collecting timing info
20:54:22.006287 [debug] [Thread-2 (]: Finished running node seed.dbt_practice.months
20:54:22.006729 [debug] [Thread-1 (]: finished collecting timing info
20:54:22.006848 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
20:54:22.006947 [debug] [Thread-1 (]: finished collecting timing info
20:54:22.007218 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
20:54:22.007965 [debug] [MainThread]: Connection 'master' was properly closed.
20:54:22.008088 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
20:54:22.008182 [debug] [MainThread]: Connection 'seed.dbt_practice.months' was properly closed.
20:54:22.012633 [info ] [MainThread]: Done.
20:54:22.014586 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
20:54:22.014729 [info ] [MainThread]: Building catalog
20:54:22.015257 [debug] [MainThread]: Opening a new connection, currently in state init
20:54:22.482435 [debug] [MainThread]: BigQuery adapter: Skipping catalog for dbt-practice-355719.mapping - schema does not exist
20:54:22.484674 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-355719.information_schema"
20:54:22.485135 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-355719.information_schema"
20:54:22.498357 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:54:22.499600 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:54:22.500845 [debug] [ThreadPool]: On dbt-practice-355719.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-355719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-355719`.`staging`.__TABLES__
        where (upper(dataset_id) = upper('staging'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-355719`.`staging`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-355719`.`staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
20:54:22.546051 [debug] [ThreadPool]: On dbt-practice-355719.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-355719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-355719`.`raw_data`.__TABLES__
        where (upper(dataset_id) = upper('raw_data'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
20:54:25.676394 [info ] [MainThread]: Catalog written to /Users/will/Projects/dbt-practice/target/catalog.json
20:54:25.676844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ffe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083fef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083fe740>]}
20:54:25.962643 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
20:54:25.963030 [debug] [MainThread]: Connection 'dbt-practice-355719.information_schema' was properly closed.
20:54:25.963186 [debug] [MainThread]: Connection 'dbt-practice-355719.information_schema' was properly closed.


============================== 2022-10-20 20:55:34.308038 | a4ac7bba-e3dd-408f-afe4-9016838a317a ==============================
20:55:34.308057 [info ] [MainThread]: Running with dbt=1.1.1
20:55:34.308405 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:55:34.308509 [debug] [MainThread]: Tracking: tracking
20:55:34.317010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a22890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a22fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20f70>]}
20:55:34.331747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:55:34.331878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:55:34.332052 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

20:55:34.334650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4ac7bba-e3dd-408f-afe4-9016838a317a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b75c30>]}
20:55:34.337661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4ac7bba-e3dd-408f-afe4-9016838a317a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af1690>]}
20:55:34.337816 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:55:34.337930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4ac7bba-e3dd-408f-afe4-9016838a317a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af17b0>]}
20:55:34.338545 [info ] [MainThread]: 
20:55:34.338754 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:55:34.339103 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719"
20:55:34.339179 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:55:34.767987 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_mapping"
20:55:34.768690 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_staging"
20:55:34.769271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:55:34.769508 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:55:35.275176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4ac7bba-e3dd-408f-afe4-9016838a317a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0b3a0>]}
20:55:35.277017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
20:55:35.277458 [info ] [MainThread]: 
20:55:35.283074 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
20:55:35.283611 [info ] [Thread-1 (]: 1 of 1 START view model staging.stg_transactions_totals ........................ [RUN]
20:55:35.284214 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
20:55:35.284401 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
20:55:35.284606 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
20:55:35.287871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
20:55:35.288602 [debug] [Thread-1 (]: finished collecting timing info
20:55:35.288764 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
20:55:35.311338 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_practice.stg_transactions_totals"
20:55:35.312542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
20:55:35.313425 [debug] [Thread-1 (]: On model.dbt_practice.stg_transactions_totals: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "node_id": "model.dbt_practice.stg_transactions_totals"} */


  create or replace view `dbt-practice-355719`.`staging`.`stg_transactions_totals`
  OPTIONS()
  as WITH
cte_1 AS (
    SELECT * FROM  `dbt-practice-355719`.`raw_data`.`transactions`
    )

SELECT
    *,
    SAFE_MULTIPLY(QTY, `VALUE`) AS TOTAL_SALES
FROM cte_1;


20:55:36.531726 [debug] [Thread-1 (]: finished collecting timing info
20:55:36.532411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4ac7bba-e3dd-408f-afe4-9016838a317a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af0250>]}
20:55:36.532810 [info ] [Thread-1 (]: 1 of 1 OK created view model staging.stg_transactions_totals ................... [[32mOK[0m in 1.25s]
20:55:36.533162 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
20:55:36.534562 [debug] [MainThread]: Acquiring new bigquery connection "master"
20:55:36.534927 [info ] [MainThread]: 
20:55:36.535272 [info ] [MainThread]: Finished running 1 view model in 2.20s.
20:55:36.535453 [debug] [MainThread]: Connection 'master' was properly closed.
20:55:36.535550 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
20:55:36.535633 [debug] [MainThread]: Connection 'list_dbt-practice-355719_staging' was properly closed.
20:55:36.539786 [info ] [MainThread]: 
20:55:36.539989 [info ] [MainThread]: [32mCompleted successfully[0m
20:55:36.540177 [info ] [MainThread]: 
20:55:36.540357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:55:36.540561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b75660>]}


============================== 2022-10-20 21:05:01.716576 | ec1536b1-cd01-404f-adc4-b96db04d824f ==============================
21:05:01.716590 [info ] [MainThread]: Running with dbt=1.1.1
21:05:01.717222 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:05:01.717309 [debug] [MainThread]: Tracking: tracking
21:05:01.726269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c6260>]}
21:05:01.744439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:05:01.744679 [debug] [MainThread]: Partial parsing: updated file: dbt_practice://macros/get_custom_schema.sql
21:05:01.744766 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
21:05:01.746101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083754b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108375540>]}


============================== 2022-10-20 21:06:03.268587 | 529b1d30-06bb-4b46-b971-0c334b988998 ==============================
21:06:03.268603 [info ] [MainThread]: Running with dbt=1.1.1
21:06:03.268931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:06:03.269028 [debug] [MainThread]: Tracking: tracking
21:06:03.276321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107047970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107044eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107047910>]}
21:06:03.290453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:06:03.290670 [debug] [MainThread]: Partial parsing: updated file: dbt_practice://macros/get_custom_schema.sql
21:06:03.290750 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
21:06:03.291950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ae0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ae140>]}


============================== 2022-10-20 21:06:28.917366 | bf7f008b-4d9c-4680-b694-696c786063cc ==============================
21:06:28.917389 [info ] [MainThread]: Running with dbt=1.1.1
21:06:28.918347 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:06:28.918722 [debug] [MainThread]: Tracking: tracking
21:06:28.928717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbafe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb9330>]}
21:06:28.944061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
21:06:28.944278 [debug] [MainThread]: Partial parsing: updated file: dbt_practice://macros/get_custom_schema.sql
21:06:28.944364 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
21:06:28.946472 [info ] [MainThread]: Change detected to override macro used during parsing. Starting full parse.
21:06:28.946601 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
21:06:28.947504 [debug] [MainThread]: Parsing macros/etc.sql
21:06:28.948359 [debug] [MainThread]: Parsing macros/catalog.sql
21:06:28.951750 [debug] [MainThread]: Parsing macros/adapters.sql
21:06:28.963158 [debug] [MainThread]: Parsing macros/materializations/seed.sql
21:06:28.964264 [debug] [MainThread]: Parsing macros/materializations/view.sql
21:06:28.965357 [debug] [MainThread]: Parsing macros/materializations/table.sql
21:06:28.967070 [debug] [MainThread]: Parsing macros/materializations/copy.sql
21:06:28.968157 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
21:06:28.974747 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
21:06:28.975414 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:06:28.977006 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:06:28.977940 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:06:28.978632 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:06:28.985942 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:06:28.991851 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:06:28.996807 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:06:28.998689 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:06:28.999432 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:06:29.000161 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:06:29.002008 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:06:29.009606 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:06:29.010231 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:06:29.014652 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:06:29.021685 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:06:29.025069 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:06:29.026251 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:06:29.029510 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:06:29.030030 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:06:29.031163 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:06:29.032081 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:06:29.034688 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:06:29.042073 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:06:29.042689 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:06:29.043710 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:06:29.044345 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:06:29.044715 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:06:29.045034 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:06:29.045310 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:06:29.045875 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:06:29.047725 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:06:29.051390 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:06:29.052257 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:06:29.053351 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:06:29.057411 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:06:29.058601 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:06:29.060428 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:06:29.063519 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:06:29.067633 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:06:29.172944 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
21:06:29.197892 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_practice.example

21:06:29.200211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf7f008b-4d9c-4680-b694-696c786063cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109197f70>]}
21:06:29.202664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf7f008b-4d9c-4680-b694-696c786063cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d2410>]}
21:06:29.202781 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:06:29.202885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf7f008b-4d9c-4680-b694-696c786063cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d2590>]}
21:06:29.203379 [info ] [MainThread]: 
21:06:29.203559 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:06:29.203841 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719"
21:06:29.203936 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:06:29.705062 [debug] [ThreadPool]: Acquiring new bigquery connection "create_dbt-practice-355719_dev_staging"
21:06:29.706143 [debug] [ThreadPool]: Acquiring new bigquery connection "create_dbt-practice-355719_dev_staging"
21:06:29.706382 [debug] [ThreadPool]: BigQuery adapter: Creating schema "dbt-practice-355719.dev_staging".
21:06:29.706617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:06:30.482656 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_dev_staging"
21:06:30.483226 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_dev_mapping"
21:06:30.483630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:06:30.483871 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:06:30.947657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf7f008b-4d9c-4680-b694-696c786063cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d1480>]}
21:06:30.957539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
21:06:30.976268 [info ] [MainThread]: 
21:06:30.985780 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
21:06:30.986249 [info ] [Thread-1 (]: 1 of 1 START view model dev_staging.stg_transactions_totals .................... [RUN]
21:06:30.986741 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
21:06:30.986889 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
21:06:30.987051 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
21:06:30.990120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
21:06:30.990686 [debug] [Thread-1 (]: finished collecting timing info
21:06:30.990824 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
21:06:31.013553 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_practice.stg_transactions_totals"
21:06:31.014027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:06:31.014904 [debug] [Thread-1 (]: On model.dbt_practice.stg_transactions_totals: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "node_id": "model.dbt_practice.stg_transactions_totals"} */


  create or replace view `dbt-practice-355719`.`dev_staging`.`stg_transactions_totals`
  OPTIONS()
  as WITH
cte_1 AS (
    SELECT * FROM  `dbt-practice-355719`.`raw_data`.`transactions`
    )

SELECT
    *,
    SAFE_MULTIPLY(QTY, `VALUE`) AS TOTAL_SALES
FROM cte_1;


21:06:32.282750 [debug] [Thread-1 (]: finished collecting timing info
21:06:32.283559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf7f008b-4d9c-4680-b694-696c786063cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa1a20>]}
21:06:32.284003 [info ] [Thread-1 (]: 1 of 1 OK created view model dev_staging.stg_transactions_totals ............... [[32mOK[0m in 1.30s]
21:06:32.284443 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
21:06:32.286221 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:06:32.286731 [info ] [MainThread]: 
21:06:32.286992 [info ] [MainThread]: Finished running 1 view model in 3.08s.
21:06:32.287206 [debug] [MainThread]: Connection 'master' was properly closed.
21:06:32.287325 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
21:06:32.287431 [debug] [MainThread]: Connection 'list_dbt-practice-355719_dev_mapping' was properly closed.
21:06:32.292359 [info ] [MainThread]: 
21:06:32.292571 [info ] [MainThread]: [32mCompleted successfully[0m
21:06:32.292790 [info ] [MainThread]: 
21:06:32.292959 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:06:32.293211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109197910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091946a0>]}


============================== 2022-10-20 21:08:25.761779 | 81422ec4-ec3f-480c-8935-79e7ea060ba9 ==============================
21:08:25.761798 [info ] [MainThread]: Running with dbt=1.1.1
21:08:25.762172 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:08:25.762253 [debug] [MainThread]: Tracking: tracking
21:08:25.769787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da1900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da2ec0>]}
21:08:25.778792 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
21:08:25.778963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '81422ec4-ec3f-480c-8935-79e7ea060ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106da0a30>]}
21:08:25.785823 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
21:08:25.787107 [debug] [MainThread]: Parsing macros/etc.sql
21:08:25.787907 [debug] [MainThread]: Parsing macros/catalog.sql
21:08:25.790948 [debug] [MainThread]: Parsing macros/adapters.sql
21:08:25.801350 [debug] [MainThread]: Parsing macros/materializations/seed.sql
21:08:25.802390 [debug] [MainThread]: Parsing macros/materializations/view.sql
21:08:25.803440 [debug] [MainThread]: Parsing macros/materializations/table.sql
21:08:25.805291 [debug] [MainThread]: Parsing macros/materializations/copy.sql
21:08:25.806367 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
21:08:25.812800 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
21:08:25.813468 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:08:25.815023 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:08:25.815935 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:08:25.816619 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:08:25.823747 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:08:25.829603 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:08:25.834703 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:08:25.836673 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:08:25.837457 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:08:25.838195 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:08:25.840014 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:08:25.847582 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:08:25.848213 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:08:25.852579 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:08:25.859495 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:08:25.862851 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:08:25.864014 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:08:25.867253 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:08:25.867772 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:08:25.868895 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:08:25.869810 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:08:25.872407 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:08:25.879686 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:08:25.880295 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:08:25.881307 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:08:25.881935 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:08:25.882302 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:08:25.882624 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:08:25.882897 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:08:25.883446 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:08:25.885260 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:08:25.888887 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:08:25.889741 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:08:25.890810 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:08:25.894922 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:08:25.896099 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:08:25.897909 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:08:25.901006 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:08:25.905073 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:08:26.006916 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
21:08:26.033778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81422ec4-ec3f-480c-8935-79e7ea060ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee9ae0>]}
21:08:26.035907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81422ec4-ec3f-480c-8935-79e7ea060ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee9000>]}
21:08:26.036014 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:08:26.036118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81422ec4-ec3f-480c-8935-79e7ea060ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee99c0>]}
21:08:26.036576 [info ] [MainThread]: 
21:08:26.036757 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:08:26.037047 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719"
21:08:26.037154 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:08:26.621941 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_dev_staging"
21:08:26.623036 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_dev_mapping"
21:08:26.623432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:08:26.623674 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:08:27.111348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81422ec4-ec3f-480c-8935-79e7ea060ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eea8c0>]}
21:08:27.113131 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
21:08:27.113502 [info ] [MainThread]: 
21:08:27.119827 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
21:08:27.120404 [info ] [Thread-1 (]: 1 of 1 START view model dev_staging.stg_transactions_totals .................... [RUN]
21:08:27.120976 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
21:08:27.121133 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
21:08:27.121305 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
21:08:27.124423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
21:08:27.125115 [debug] [Thread-1 (]: finished collecting timing info
21:08:27.125269 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
21:08:27.147713 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_practice.stg_transactions_totals"
21:08:27.148184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:08:27.149065 [debug] [Thread-1 (]: On model.dbt_practice.stg_transactions_totals: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "node_id": "model.dbt_practice.stg_transactions_totals"} */


  create or replace view `dbt-practice-355719`.`dev_staging`.`stg_transactions_totals`
  OPTIONS()
  as WITH
cte_1 AS (
    SELECT * FROM  `dbt-practice-355719`.`raw_data`.`transactions`
    )

SELECT
    *,
    SAFE_MULTIPLY(QTY, `VALUE`) AS TOTAL_SALES
FROM cte_1;


21:08:28.320930 [debug] [Thread-1 (]: finished collecting timing info
21:08:28.321611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81422ec4-ec3f-480c-8935-79e7ea060ba9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d97a60>]}
21:08:28.322038 [info ] [Thread-1 (]: 1 of 1 OK created view model dev_staging.stg_transactions_totals ............... [[32mOK[0m in 1.20s]
21:08:28.322489 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
21:08:28.324212 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:08:28.324681 [info ] [MainThread]: 
21:08:28.324831 [info ] [MainThread]: Finished running 1 view model in 2.29s.
21:08:28.324930 [debug] [MainThread]: Connection 'master' was properly closed.
21:08:28.324981 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
21:08:28.325027 [debug] [MainThread]: Connection 'list_dbt-practice-355719_dev_mapping' was properly closed.
21:08:28.328196 [info ] [MainThread]: 
21:08:28.328309 [info ] [MainThread]: [32mCompleted successfully[0m
21:08:28.328436 [info ] [MainThread]: 
21:08:28.328638 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:08:28.328888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045725c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef6ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef12d0>]}


============================== 2022-10-20 21:08:46.628426 | d0707781-4c9b-4d5f-8571-3465fe935abc ==============================
21:08:46.628454 [info ] [MainThread]: Running with dbt=1.1.1
21:08:46.628807 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'prod', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:08:46.628929 [debug] [MainThread]: Tracking: tracking
21:08:46.636095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086247c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086271f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108624d60>]}
21:08:46.644331 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
21:08:46.644482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0707781-4c9b-4d5f-8571-3465fe935abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108625720>]}
21:08:46.650966 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
21:08:46.652295 [debug] [MainThread]: Parsing macros/etc.sql
21:08:46.653113 [debug] [MainThread]: Parsing macros/catalog.sql
21:08:46.656180 [debug] [MainThread]: Parsing macros/adapters.sql
21:08:46.666836 [debug] [MainThread]: Parsing macros/materializations/seed.sql
21:08:46.667896 [debug] [MainThread]: Parsing macros/materializations/view.sql
21:08:46.668961 [debug] [MainThread]: Parsing macros/materializations/table.sql
21:08:46.670834 [debug] [MainThread]: Parsing macros/materializations/copy.sql
21:08:46.671928 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
21:08:46.678444 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
21:08:46.679120 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:08:46.680692 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:08:46.681616 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:08:46.682304 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:08:46.689516 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:08:46.695401 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:08:46.700327 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:08:46.702198 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:08:46.702922 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:08:46.703653 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:08:46.705473 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:08:46.713090 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:08:46.713712 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:08:46.718095 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:08:46.725014 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:08:46.728379 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:08:46.729550 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:08:46.732813 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:08:46.733330 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:08:46.734455 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:08:46.735367 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:08:46.737966 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:08:46.745265 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:08:46.745874 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:08:46.746891 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:08:46.747518 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:08:46.747882 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:08:46.748198 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:08:46.748468 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:08:46.749018 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:08:46.750842 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:08:46.754478 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:08:46.755329 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:08:46.756408 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:08:46.760450 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:08:46.761614 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:08:46.763416 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:08:46.766493 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:08:46.770571 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:08:46.873492 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
21:08:46.900320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0707781-4c9b-4d5f-8571-3465fe935abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108776d10>]}
21:08:46.902418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0707781-4c9b-4d5f-8571-3465fe935abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108777bb0>]}
21:08:46.902526 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:08:46.902633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0707781-4c9b-4d5f-8571-3465fe935abc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108775360>]}
21:08:46.903103 [info ] [MainThread]: 
21:08:46.903285 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:08:46.903557 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719"
21:08:46.903624 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:08:46.903699 [debug] [ThreadPool]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
21:08:46.903914 [debug] [MainThread]: Connection 'master' was properly closed.
21:08:46.903966 [debug] [MainThread]: Connection 'list_dbt-practice-355719' was properly closed.
21:08:46.904092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774d30>]}


============================== 2022-10-20 21:08:56.019335 | 23641a24-a00a-4b02-93ec-afe4ab2a2251 ==============================
21:08:56.019349 [info ] [MainThread]: Running with dbt=1.1.1
21:08:56.019685 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:08:56.019780 [debug] [MainThread]: Tracking: tracking
21:08:56.026315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105123700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105121900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105122e90>]}
21:08:56.035044 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
21:08:56.035228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23641a24-a00a-4b02-93ec-afe4ab2a2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105120a90>]}
21:08:56.041613 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
21:08:56.042939 [debug] [MainThread]: Parsing macros/etc.sql
21:08:56.043766 [debug] [MainThread]: Parsing macros/catalog.sql
21:08:56.046838 [debug] [MainThread]: Parsing macros/adapters.sql
21:08:56.057421 [debug] [MainThread]: Parsing macros/materializations/seed.sql
21:08:56.058476 [debug] [MainThread]: Parsing macros/materializations/view.sql
21:08:56.059540 [debug] [MainThread]: Parsing macros/materializations/table.sql
21:08:56.061410 [debug] [MainThread]: Parsing macros/materializations/copy.sql
21:08:56.062495 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
21:08:56.068958 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
21:08:56.069632 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:08:56.071201 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:08:56.072128 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:08:56.072814 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:08:56.080000 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:08:56.085875 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:08:56.090810 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:08:56.092672 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:08:56.093395 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:08:56.094116 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:08:56.095923 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:08:56.103544 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:08:56.104169 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:08:56.108606 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:08:56.115541 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:08:56.118903 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:08:56.120064 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:08:56.123313 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:08:56.123831 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:08:56.124966 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:08:56.125888 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:08:56.128474 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:08:56.135798 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:08:56.136394 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:08:56.137402 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:08:56.138041 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:08:56.138406 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:08:56.138728 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:08:56.138998 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:08:56.139547 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:08:56.141370 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:08:56.145011 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:08:56.145866 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:08:56.146937 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:08:56.150983 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:08:56.152151 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:08:56.153952 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:08:56.157053 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:08:56.161120 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:08:56.263116 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
21:08:56.289747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23641a24-a00a-4b02-93ec-afe4ab2a2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526a380>]}
21:08:56.291881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23641a24-a00a-4b02-93ec-afe4ab2a2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526a020>]}
21:08:56.291988 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:08:56.292096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23641a24-a00a-4b02-93ec-afe4ab2a2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d88520>]}
21:08:56.292564 [info ] [MainThread]: 
21:08:56.292737 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:08:56.293016 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719"
21:08:56.293084 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:08:56.712504 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_dev_staging"
21:08:56.713428 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_dev_mapping"
21:08:56.713898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:08:56.714114 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:08:57.190469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23641a24-a00a-4b02-93ec-afe4ab2a2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526b070>]}
21:08:57.192009 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
21:08:57.192475 [info ] [MainThread]: 
21:08:57.197388 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
21:08:57.197862 [info ] [Thread-1 (]: 1 of 1 START view model dev_staging.stg_transactions_totals .................... [RUN]
21:08:57.198353 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
21:08:57.198509 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
21:08:57.198669 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
21:08:57.201718 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
21:08:57.202357 [debug] [Thread-1 (]: finished collecting timing info
21:08:57.202502 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
21:08:57.225773 [debug] [Thread-1 (]: Writing runtime SQL for node "model.dbt_practice.stg_transactions_totals"
21:08:57.226300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
21:08:57.227241 [debug] [Thread-1 (]: On model.dbt_practice.stg_transactions_totals: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "node_id": "model.dbt_practice.stg_transactions_totals"} */


  create or replace view `dbt-practice-355719`.`dev_staging`.`stg_transactions_totals`
  OPTIONS()
  as WITH
cte_1 AS (
    SELECT * FROM  `dbt-practice-355719`.`raw_data`.`transactions`
    )

SELECT
    *,
    SAFE_MULTIPLY(QTY, `VALUE`) AS TOTAL_SALES
FROM cte_1;


21:08:58.416674 [debug] [Thread-1 (]: finished collecting timing info
21:08:58.417424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23641a24-a00a-4b02-93ec-afe4ab2a2251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105117a30>]}
21:08:58.417829 [info ] [Thread-1 (]: 1 of 1 OK created view model dev_staging.stg_transactions_totals ............... [[32mOK[0m in 1.22s]
21:08:58.418246 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
21:08:58.419968 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:08:58.420405 [info ] [MainThread]: 
21:08:58.420634 [info ] [MainThread]: Finished running 1 view model in 2.13s.
21:08:58.420818 [debug] [MainThread]: Connection 'master' was properly closed.
21:08:58.420912 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
21:08:58.420991 [debug] [MainThread]: Connection 'list_dbt-practice-355719_dev_mapping' was properly closed.
21:08:58.426083 [info ] [MainThread]: 
21:08:58.426301 [info ] [MainThread]: [32mCompleted successfully[0m
21:08:58.426498 [info ] [MainThread]: 
21:08:58.426654 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
21:08:58.426865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028f2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105277460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105121840>]}


============================== 2022-10-20 21:10:33.004999 | eac52045-a510-4a20-9125-8e802177b35a ==============================
21:10:33.005019 [info ] [MainThread]: Running with dbt=1.1.1
21:10:33.005592 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
21:10:33.005825 [debug] [MainThread]: Tracking: tracking
21:10:33.015119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106620790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106620130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623e80>]}
21:10:33.034063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:10:33.034194 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:10:33.036926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eac52045-a510-4a20-9125-8e802177b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067797b0>]}
21:10:33.039842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eac52045-a510-4a20-9125-8e802177b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5270>]}
21:10:33.039973 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 192 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
21:10:33.040092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac52045-a510-4a20-9125-8e802177b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5390>]}
21:10:33.040758 [info ] [MainThread]: 
21:10:33.040958 [debug] [MainThread]: Acquiring new bigquery connection "master"
21:10:33.041270 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_dev_mapping"
21:10:33.041434 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-355719_dev_staging"
21:10:33.041537 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:10:33.041623 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:10:33.579911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac52045-a510-4a20-9125-8e802177b35a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5060>]}
21:10:33.581955 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
21:10:33.582419 [info ] [MainThread]: 
21:10:33.590504 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
21:10:33.590757 [debug] [Thread-2 (]: Began running node seed.dbt_practice.months
21:10:33.591463 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
21:10:33.591733 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.dbt_practice.months"
21:10:33.591888 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
21:10:33.592017 [debug] [Thread-2 (]: Began compiling node seed.dbt_practice.months
21:10:33.592188 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
21:10:33.592315 [debug] [Thread-2 (]: Compiling seed.dbt_practice.months
21:10:33.595772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
21:10:33.596962 [debug] [Thread-2 (]: Writing injected SQL for node "seed.dbt_practice.months"
21:10:33.597255 [debug] [Thread-2 (]: finished collecting timing info
21:10:33.597410 [debug] [Thread-2 (]: Began executing node seed.dbt_practice.months
21:10:33.597566 [debug] [Thread-2 (]: finished collecting timing info
21:10:33.597925 [debug] [Thread-2 (]: Finished running node seed.dbt_practice.months
21:10:33.598292 [debug] [Thread-1 (]: finished collecting timing info
21:10:33.598406 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
21:10:33.598511 [debug] [Thread-1 (]: finished collecting timing info
21:10:33.598782 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
21:10:33.599472 [debug] [MainThread]: Connection 'master' was properly closed.
21:10:33.599606 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
21:10:33.599706 [debug] [MainThread]: Connection 'seed.dbt_practice.months' was properly closed.
21:10:33.604565 [info ] [MainThread]: Done.
21:10:33.606643 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
21:10:33.606780 [info ] [MainThread]: Building catalog
21:10:33.607249 [debug] [MainThread]: Opening a new connection, currently in state init
21:10:34.064564 [debug] [MainThread]: BigQuery adapter: Skipping catalog for dbt-practice-355719.dev_mapping - schema does not exist
21:10:34.065395 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-355719.information_schema"
21:10:34.071236 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-355719.information_schema"
21:10:34.078099 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:10:34.079288 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:10:34.080437 [debug] [ThreadPool]: On dbt-practice-355719.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-355719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-355719`.`dev_staging`.__TABLES__
        where (upper(dataset_id) = upper('dev_staging'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-355719`.`dev_staging`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-355719`.`dev_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
21:10:34.081191 [debug] [ThreadPool]: On dbt-practice-355719.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-355719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-355719`.`raw_data`.__TABLES__
        where (upper(dataset_id) = upper('raw_data'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
21:10:37.175520 [info ] [MainThread]: Catalog written to /Users/will/Projects/dbt-practice/target/catalog.json
21:10:37.175993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106620790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106622140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623370>]}
21:10:37.456869 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
21:10:37.457417 [debug] [MainThread]: Connection 'dbt-practice-355719.information_schema' was properly closed.
21:10:37.457609 [debug] [MainThread]: Connection 'dbt-practice-355719.information_schema' was properly closed.


============================== 2022-10-20 21:10:47.427423 | 7a8c4789-9600-4310-9bdf-921fc7127c2e ==============================
21:10:47.427457 [info ] [MainThread]: Running with dbt=1.1.1
21:10:47.428413 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
21:10:47.428549 [debug] [MainThread]: Tracking: tracking
21:10:47.436836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107224100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107225cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107225ea0>]}
21:10:47.438823 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
21:10:47.438964 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
21:10:47.439245 [info ] [MainThread]: 
21:10:47.439352 [info ] [MainThread]: 
21:10:47.439436 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-10-21 11:17:39.564011 | cfece03b-7b34-466b-a90a-241bde37142b ==============================
11:17:39.564017 [info ] [MainThread]: Running with dbt=1.1.1
11:17:39.564209 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
11:17:39.564269 [debug] [MainThread]: Tracking: tracking
11:17:39.575696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107980100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107787ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079223b0>]}
11:17:39.576786 [debug] [MainThread]: Set downloads directory='/var/folders/cp/z9d7txd14rs6381w7m3fdt600000gn/T/dbt-downloads-fbk7n423'
11:17:39.577067 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
11:17:39.719615 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
11:17:39.719952 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
11:17:39.965872 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
11:17:39.970855 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
11:17:40.057687 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
11:17:40.106977 [info ] [MainThread]: Installing dbt-labs/codegen
11:17:40.395831 [info ] [MainThread]:   Installed from version 0.8.1
11:17:40.396165 [info ] [MainThread]:   Up to date!
11:17:40.396419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cfece03b-7b34-466b-a90a-241bde37142b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107923850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107923040>]}
11:17:40.396709 [info ] [MainThread]: Installing dbt-labs/dbt_utils
11:17:40.711568 [info ] [MainThread]:   Installed from version 0.9.2
11:17:40.711774 [info ] [MainThread]:   Up to date!
11:17:40.711921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cfece03b-7b34-466b-a90a-241bde37142b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079cff10>]}
11:17:40.712379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107980730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107922d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107922fe0>]}


============================== 2022-10-21 11:19:39.027666 | 16950a52-d24a-4b25-a731-7a3f369dc1f9 ==============================
11:19:39.027687 [info ] [MainThread]: Running with dbt=1.1.1
11:19:39.028010 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_source', 'args': 'schema_name: raw_data', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
11:19:39.028111 [debug] [MainThread]: Tracking: tracking
11:19:39.035307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105134490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105135180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105136650>]}
11:19:39.043144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051349a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105136d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105135c60>]}


============================== 2022-10-21 11:21:02.078551 | 383594c7-7d53-4236-842f-cd255e9904d2 ==============================
11:21:02.078581 [info ] [MainThread]: Running with dbt=1.1.1
11:21:02.079894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': False, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_source', 'args': 'schema_name: raw_data', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
11:21:02.080062 [debug] [MainThread]: Tracking: tracking
11:21:02.091993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f32e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f33490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f325f0>]}
11:21:02.108918 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
11:21:02.109122 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
11:21:02.109222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '383594c7-7d53-4236-842f-cd255e9904d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f31000>]}
11:21:02.127013 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
11:21:02.128254 [debug] [MainThread]: Parsing macros/etc.sql
11:21:02.129059 [debug] [MainThread]: Parsing macros/catalog.sql
11:21:02.132152 [debug] [MainThread]: Parsing macros/adapters.sql
11:21:02.142802 [debug] [MainThread]: Parsing macros/materializations/seed.sql
11:21:02.143829 [debug] [MainThread]: Parsing macros/materializations/view.sql
11:21:02.144882 [debug] [MainThread]: Parsing macros/materializations/table.sql
11:21:02.146508 [debug] [MainThread]: Parsing macros/materializations/copy.sql
11:21:02.147581 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
11:21:02.154026 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
11:21:02.154700 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
11:21:02.156255 [debug] [MainThread]: Parsing macros/materializations/configs.sql
11:21:02.157177 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
11:21:02.157863 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
11:21:02.165071 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
11:21:02.170948 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
11:21:02.175866 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
11:21:02.177817 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
11:21:02.178551 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
11:21:02.179276 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
11:21:02.181094 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
11:21:02.188653 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
11:21:02.189269 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
11:21:02.193642 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
11:21:02.200562 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
11:21:02.203938 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
11:21:02.205108 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
11:21:02.208350 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
11:21:02.208861 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
11:21:02.209983 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
11:21:02.210892 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
11:21:02.213477 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
11:21:02.220900 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
11:21:02.221502 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
11:21:02.222511 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
11:21:02.223136 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
11:21:02.223510 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
11:21:02.223831 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
11:21:02.224099 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
11:21:02.224649 [debug] [MainThread]: Parsing macros/etc/statement.sql
11:21:02.226484 [debug] [MainThread]: Parsing macros/etc/datetime.sql
11:21:02.230130 [debug] [MainThread]: Parsing macros/adapters/schema.sql
11:21:02.230981 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
11:21:02.232057 [debug] [MainThread]: Parsing macros/adapters/relation.sql
11:21:02.236088 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
11:21:02.237277 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
11:21:02.239090 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
11:21:02.242148 [debug] [MainThread]: Parsing macros/adapters/columns.sql
11:21:02.246236 [debug] [MainThread]: Parsing tests/generic/builtin.sql
11:21:02.247478 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
11:21:02.248569 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
11:21:02.250208 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
11:21:02.251067 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
11:21:02.252254 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
11:21:02.253253 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
11:21:02.253769 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
11:21:02.254414 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
11:21:02.254957 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
11:21:02.257809 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
11:21:02.258357 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
11:21:02.259004 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
11:21:02.259517 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
11:21:02.260077 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
11:21:02.260677 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
11:21:02.261426 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
11:21:02.262073 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
11:21:02.262680 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
11:21:02.263277 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
11:21:02.263792 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
11:21:02.264441 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
11:21:02.264987 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
11:21:02.265587 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
11:21:02.266127 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
11:21:02.266677 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
11:21:02.267325 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
11:21:02.267939 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
11:21:02.268655 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
11:21:02.269244 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
11:21:02.280764 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
11:21:02.281604 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
11:21:02.282629 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
11:21:02.283256 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
11:21:02.284000 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
11:21:02.284685 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
11:21:02.285642 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
11:21:02.286341 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
11:21:02.286852 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
11:21:02.287988 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
11:21:02.288896 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
11:21:02.289472 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
11:21:02.289984 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
11:21:02.291171 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
11:21:02.292032 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
11:21:02.292762 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
11:21:02.293677 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
11:21:02.295030 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
11:21:02.295607 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
11:21:02.297106 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
11:21:02.301543 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
11:21:02.301991 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
11:21:02.302446 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
11:21:02.302920 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
11:21:02.303353 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
11:21:02.303825 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
11:21:02.304621 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
11:21:02.328413 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
11:21:02.329187 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
11:21:02.330638 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
11:21:02.332463 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
11:21:02.333875 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
11:21:02.334549 [debug] [MainThread]: Parsing macros/sql/star.sql
11:21:02.336188 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
11:21:02.339598 [debug] [MainThread]: Parsing macros/sql/union.sql
11:21:02.344845 [debug] [MainThread]: Parsing macros/sql/groupby.sql
11:21:02.345400 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
11:21:02.348495 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
11:21:02.349895 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
11:21:02.350553 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
11:21:02.351211 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
11:21:02.354184 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
11:21:02.356570 [debug] [MainThread]: Parsing macros/sql/pivot.sql
11:21:02.358334 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
11:21:02.359468 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
11:21:02.361752 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
11:21:02.362708 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
11:21:02.363354 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
11:21:02.365936 [debug] [MainThread]: Parsing macros/generate_model_import_ctes.sql
11:21:02.376501 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
11:21:02.379116 [debug] [MainThread]: Parsing macros/generate_base_model.sql
11:21:02.380868 [debug] [MainThread]: Parsing macros/generate_source.sql
11:21:02.384779 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
11:21:02.465737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0a920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f086a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f0b340>]}


============================== 2022-10-21 11:52:29.937325 | 304d8de8-1114-45d3-a357-2101f23bc741 ==============================
[0m11:52:29.937356 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:52:29.937922 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_source', 'args': 'schema_name: raw_data', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m11:52:29.938017 [debug] [MainThread]: Tracking: tracking
[0m11:52:29.951526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1f4f0>]}
[0m11:52:29.973755 [debug] [MainThread]: Failed to load parsed file from disk at /Users/will/Projects/dbt-practice/target/partial_parse.msgpack: Field "nodes" of type MutableMapping[str, Union[CompiledAnalysisNode, CompiledSingularTestNode, CompiledModelNode, CompiledHookNode, CompiledRPCNode, CompiledSqlNode, CompiledGenericTestNode, CompiledSeedNode, CompiledSnapshotNode, ParsedAnalysisNode, ParsedSingularTestNode, ParsedHookNode, ParsedModelNode, ParsedRPCNode, ParsedSqlNode, ParsedGenericTestNode, ParsedSeedNode, ParsedSnapshotNode]] in Manifest has invalid value {'model.dbt_practice.stg_transactions_totals': {'raw_sql': "WITH\ncte_1 AS (\n    SELECT * FROM  {{ source('raw_data', 'transactions') }}\n    )\n\nSELECT\n    *,\n    SAFE_MULTIPLY(QTY, `VALUE`) AS TOTAL_SALES\nFROM cte_1", 'resource_type': 'model', 'depends_on': {'macros': [], 'nodes': ['source.dbt_practice.raw_data.transactions']}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'view', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'post-hook': [], 'pre-hook': []}, 'database': 'dbt-practice-355719', 'schema': 'dev_staging', 'fqn': ['dbt_practice', 'staging', 'stg_transactions_totals'], 'unique_id': 'model.dbt_practice.stg_transactions_totals', 'package_name': 'dbt_practice', 'root_path': '/Users/will/Projects/dbt-practice', 'path': 'staging/stg_transactions_totals.sql', 'original_file_path': 'models/staging/stg_transactions_totals.sql', 'name': 'stg_transactions_totals', 'alias': 'stg_transactions_totals', 'checksum': {'name': 'sha256', 'checksum': '483fc81fb93c7c8445960010805d2abc3d429b03184ac18a46efbc3a5545b2db'}, 'tags': [], 'refs': [], 'sources': [['raw_data', 'transactions']], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1666300136.262799}, 'seed.dbt_practice.months': {'raw_sql': '', 'resource_type': 'seed', 'depends_on': {'macros': [], 'nodes': []}, 'config': {'enabled': True, 'alias': None, 'schema': None, 'database': None, 'tags': [], 'meta': {}, 'materialized': 'seed', 'persist_docs': {}, 'quoting': {}, 'column_types': {}, 'full_refresh': None, 'unique_key': None, 'on_schema_change': 'ignore', 'quote_columns': None, 'post-hook': [], 'pre-hook': []}, 'database': 'dbt-practice-355719', 'schema': 'dev_mapping', 'fqn': ['dbt_practice', 'mapping', 'months'], 'unique_id': 'seed.dbt_practice.months', 'package_name': 'dbt_practice', 'root_path': '/Users/will/Projects/dbt-practice', 'path': 'mapping/months.csv', 'original_file_path': 'seeds/mapping/months.csv', 'name': 'months', 'alias': 'months', 'checksum': {'name': 'sha256', 'checksum': '921878ad2ceef0065e745e652f529f7850c0e2198e0151f043ea87d5c3931561'}, 'tags': [], 'refs': [], 'sources': [], 'description': '', 'columns': {}, 'meta': {}, 'docs': {'show': True}, 'patch_path': None, 'compiled_path': None, 'build_path': None, 'deferred': False, 'unrendered_config': {}, 'created_at': 1666300136.272287}}
[0m11:52:29.973973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '304d8de8-1114-45d3-a357-2101f23bc741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1f490>]}
[0m11:52:29.994815 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
[0m11:52:29.996008 [debug] [MainThread]: Parsing macros/etc.sql
[0m11:52:29.996799 [debug] [MainThread]: Parsing macros/catalog.sql
[0m11:52:29.999864 [debug] [MainThread]: Parsing macros/adapters.sql
[0m11:52:30.009025 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m11:52:30.010038 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m11:52:30.011184 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m11:52:30.014529 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m11:52:30.015641 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m11:52:30.023214 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m11:52:30.023922 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:52:30.024089 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:52:30.024350 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m11:52:30.024774 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:52:30.024921 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:52:30.025145 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:52:30.025403 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:52:30.025802 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:52:30.026297 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:52:30.026493 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:52:30.026682 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:52:30.026891 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:52:30.027089 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:52:30.027258 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:52:30.027865 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:52:30.028073 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:52:30.028400 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:52:30.028635 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:52:30.029676 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:52:30.031220 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:52:30.032138 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:52:30.032819 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:52:30.039661 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:52:30.045481 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:52:30.050793 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:52:30.052656 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:52:30.053376 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:52:30.054098 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:52:30.057437 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:52:30.064338 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:52:30.064948 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:52:30.067733 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:52:30.072318 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:52:30.079835 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:52:30.082162 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:52:30.083572 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:52:30.085905 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:52:30.086410 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:52:30.087788 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:52:30.088700 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:52:30.091660 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:52:30.099793 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:52:30.100421 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:52:30.101432 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:52:30.102051 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:52:30.102419 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:52:30.102728 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:52:30.102996 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:52:30.103542 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:52:30.105716 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:52:30.109260 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:52:30.109583 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:52:30.110070 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:52:30.110449 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:52:30.110815 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:52:30.111307 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:52:30.111620 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:52:30.112036 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:52:30.112527 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:52:30.113474 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:52:30.113960 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:52:30.114383 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:52:30.114804 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:52:30.115216 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:52:30.115574 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:52:30.115997 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:52:30.116351 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:52:30.119090 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:52:30.119510 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:52:30.119870 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:52:30.120583 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:52:30.121490 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:52:30.121899 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:52:30.122526 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:52:30.122946 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:52:30.123783 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:52:30.125135 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:52:30.126259 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:52:30.132536 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:52:30.133326 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:52:30.138972 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:52:30.140766 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:52:30.143769 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:52:30.147863 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:52:30.150454 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:52:30.151647 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m11:52:30.152806 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m11:52:30.154368 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m11:52:30.155195 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m11:52:30.156386 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m11:52:30.157507 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
[0m11:52:30.158014 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
[0m11:52:30.158645 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
[0m11:52:30.159183 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
[0m11:52:30.162009 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
[0m11:52:30.162566 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
[0m11:52:30.163200 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
[0m11:52:30.163710 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
[0m11:52:30.164274 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
[0m11:52:30.164864 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
[0m11:52:30.165598 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
[0m11:52:30.166245 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
[0m11:52:30.166836 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
[0m11:52:30.167425 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
[0m11:52:30.167939 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
[0m11:52:30.168578 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
[0m11:52:30.169120 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
[0m11:52:30.169712 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
[0m11:52:30.170253 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
[0m11:52:30.170791 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
[0m11:52:30.171438 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
[0m11:52:30.172036 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
[0m11:52:30.172743 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
[0m11:52:30.173324 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m11:52:30.184669 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m11:52:30.185438 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m11:52:30.186427 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m11:52:30.187033 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m11:52:30.187774 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m11:52:30.188440 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m11:52:30.189385 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m11:52:30.190066 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m11:52:30.190551 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m11:52:30.191608 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m11:52:30.192470 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m11:52:30.193026 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m11:52:30.193521 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m11:52:30.194679 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m11:52:30.195514 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m11:52:30.196231 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m11:52:30.197118 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m11:52:30.198325 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m11:52:30.198883 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m11:52:30.200349 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m11:52:30.204712 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m11:52:30.205144 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m11:52:30.205592 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m11:52:30.206061 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m11:52:30.206485 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m11:52:30.206949 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m11:52:30.207730 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m11:52:30.209499 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m11:52:30.210136 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m11:52:30.211528 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m11:52:30.213307 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m11:52:30.214685 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m11:52:30.215344 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m11:52:30.216927 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m11:52:30.220279 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m11:52:30.225458 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m11:52:30.225993 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m11:52:30.229060 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m11:52:30.230448 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m11:52:30.231090 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m11:52:30.231742 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m11:52:30.234699 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m11:52:30.237063 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m11:52:30.238773 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m11:52:30.239887 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m11:52:30.242129 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m11:52:30.243052 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m11:52:30.243683 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m11:52:30.247443 [debug] [MainThread]: Parsing macros/generate_model_import_ctes.sql
[0m11:52:30.257327 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m11:52:30.259897 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m11:52:30.261608 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m11:52:30.265437 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m11:52:30.450264 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
[0m11:52:30.532120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '304d8de8-1114-45d3-a357-2101f23bc741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dafee0>]}
[0m11:52:30.536757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '304d8de8-1114-45d3-a357-2101f23bc741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c33130>]}
[0m11:52:30.537077 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_source"
[0m11:52:30.553593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:30.553731 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
[0m11:52:30.553828 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
macro generate_source
[0m11:52:30.553876 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 2] No such file or directory: '/secrets/dbt-service-account'
[0m11:52:30.554073 [error] [MainThread]: Encountered an error while running operation: Database Error
  [Errno 2] No such file or directory: '/secrets/dbt-service-account'
[0m11:52:30.554184 [debug] [MainThread]: 
[0m11:52:30.554303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d77a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d76230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d76a70>]}
[0m11:52:30.554392 [debug] [MainThread]: Flushing usage events
[0m11:52:30.812062 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.


============================== 2022-10-21 11:54:05.581760 | 0d87e871-ce3b-49c6-a1ea-72209869c3da ==============================
[0m11:54:05.581780 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:54:05.582374 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'generate_source', 'args': 'schema_name: raw_data', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m11:54:05.582651 [debug] [MainThread]: Tracking: tracking
[0m11:54:05.592196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ffa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fd630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fd6c0>]}
[0m11:54:05.647533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:54:05.647681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:54:05.650997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d87e871-ce3b-49c6-a1ea-72209869c3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba80d0>]}
[0m11:54:05.655726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d87e871-ce3b-49c6-a1ea-72209869c3da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae7580>]}
[0m11:54:05.656088 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_source"
[0m11:54:05.673104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:05.673277 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '/secrets/dbt-service-account''
[0m11:54:05.673393 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
macro generate_source
[0m11:54:05.673442 [debug] [MainThread]: BigQuery adapter: Database Error
  [Errno 2] No such file or directory: '/secrets/dbt-service-account'
[0m11:54:05.673639 [error] [MainThread]: Encountered an error while running operation: Database Error
  [Errno 2] No such file or directory: '/secrets/dbt-service-account'
[0m11:54:05.673750 [debug] [MainThread]: 
[0m11:54:05.673886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b91480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b91d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b922c0>]}
[0m11:54:05.673979 [debug] [MainThread]: Flushing usage events
[0m11:54:05.886328 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.


============================== 2022-10-21 11:54:22.178063 | 3e5172cd-90f7-4839-8704-a7093511702a ==============================
[0m11:54:22.178098 [info ] [MainThread]: Running with dbt=1.3.0
[0m11:54:22.178522 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'macro': 'generate_source', 'args': 'schema_name: raw_data', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
[0m11:54:22.178606 [debug] [MainThread]: Tracking: tracking
[0m11:54:22.189988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a87370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a855d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a85f60>]}
[0m11:54:22.216504 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:54:22.216716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3e5172cd-90f7-4839-8704-a7093511702a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6aef0>]}
[0m11:54:22.242272 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
[0m11:54:22.243559 [debug] [MainThread]: Parsing macros/etc.sql
[0m11:54:22.244343 [debug] [MainThread]: Parsing macros/catalog.sql
[0m11:54:22.247473 [debug] [MainThread]: Parsing macros/adapters.sql
[0m11:54:22.256662 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m11:54:22.257675 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m11:54:22.258908 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m11:54:22.262230 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m11:54:22.263351 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m11:54:22.270857 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m11:54:22.271520 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:54:22.271669 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:54:22.271924 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m11:54:22.272353 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:54:22.272497 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:54:22.272714 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:54:22.272973 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:54:22.273365 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:54:22.273852 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:54:22.274049 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:54:22.274246 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:54:22.274486 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:54:22.274694 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:54:22.274875 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:54:22.275487 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:54:22.275695 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:54:22.276013 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:54:22.276249 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:54:22.277288 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m11:54:22.278829 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m11:54:22.279738 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m11:54:22.280415 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m11:54:22.287266 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m11:54:22.293144 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m11:54:22.298571 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m11:54:22.300442 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m11:54:22.301175 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m11:54:22.301898 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m11:54:22.305236 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m11:54:22.312126 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m11:54:22.312732 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m11:54:22.315538 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m11:54:22.319946 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m11:54:22.327495 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m11:54:22.329811 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m11:54:22.331252 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m11:54:22.333584 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m11:54:22.334094 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m11:54:22.335463 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m11:54:22.336356 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m11:54:22.339320 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m11:54:22.347347 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m11:54:22.347961 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m11:54:22.348956 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m11:54:22.349575 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m11:54:22.349938 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m11:54:22.350250 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m11:54:22.350518 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m11:54:22.351059 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m11:54:22.353220 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m11:54:22.356776 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m11:54:22.357104 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m11:54:22.357586 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m11:54:22.357962 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m11:54:22.358325 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m11:54:22.358815 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m11:54:22.359130 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m11:54:22.359529 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m11:54:22.360011 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m11:54:22.360953 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m11:54:22.361446 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m11:54:22.361872 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m11:54:22.362291 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m11:54:22.362704 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m11:54:22.363073 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m11:54:22.363539 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m11:54:22.363905 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m11:54:22.366617 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m11:54:22.367041 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m11:54:22.367395 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m11:54:22.368109 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m11:54:22.369011 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m11:54:22.369412 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m11:54:22.370003 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m11:54:22.370416 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m11:54:22.371257 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m11:54:22.372641 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m11:54:22.373763 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m11:54:22.380186 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m11:54:22.381041 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m11:54:22.386765 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m11:54:22.388635 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m11:54:22.391632 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m11:54:22.395907 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m11:54:22.398524 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m11:54:22.399733 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m11:54:22.400890 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m11:54:22.402450 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m11:54:22.403290 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m11:54:22.404538 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m11:54:22.405531 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
[0m11:54:22.406044 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
[0m11:54:22.406674 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
[0m11:54:22.407215 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
[0m11:54:22.410055 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
[0m11:54:22.410604 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
[0m11:54:22.411243 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
[0m11:54:22.411782 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
[0m11:54:22.412379 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
[0m11:54:22.412967 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
[0m11:54:22.413705 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
[0m11:54:22.414353 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
[0m11:54:22.414944 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
[0m11:54:22.415529 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
[0m11:54:22.416043 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
[0m11:54:22.416681 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
[0m11:54:22.417227 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
[0m11:54:22.417814 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
[0m11:54:22.418347 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
[0m11:54:22.418880 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
[0m11:54:22.419523 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
[0m11:54:22.420177 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
[0m11:54:22.420891 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
[0m11:54:22.421468 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m11:54:22.432804 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m11:54:22.433572 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m11:54:22.434551 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m11:54:22.435145 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m11:54:22.435893 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m11:54:22.436620 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m11:54:22.437561 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m11:54:22.438245 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m11:54:22.438735 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m11:54:22.439798 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m11:54:22.440657 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m11:54:22.441215 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m11:54:22.441712 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m11:54:22.442861 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m11:54:22.443697 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m11:54:22.444457 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m11:54:22.445357 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m11:54:22.446561 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m11:54:22.447123 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m11:54:22.448648 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m11:54:22.453273 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m11:54:22.453780 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m11:54:22.454254 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m11:54:22.454749 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m11:54:22.455192 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m11:54:22.455677 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m11:54:22.456493 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m11:54:22.458740 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m11:54:22.459488 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m11:54:22.460966 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m11:54:22.462788 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m11:54:22.464197 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m11:54:22.464878 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m11:54:22.466467 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m11:54:22.469876 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m11:54:22.475162 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m11:54:22.475697 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m11:54:22.478821 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m11:54:22.480203 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m11:54:22.480851 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m11:54:22.481499 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m11:54:22.484427 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m11:54:22.486872 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m11:54:22.488598 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m11:54:22.489707 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m11:54:22.491953 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m11:54:22.492934 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m11:54:22.493588 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m11:54:22.496591 [debug] [MainThread]: Parsing macros/generate_model_import_ctes.sql
[0m11:54:22.506536 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m11:54:22.509131 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m11:54:22.510865 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m11:54:22.514700 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m11:54:22.733012 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
[0m11:54:22.783085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e5172cd-90f7-4839-8704-a7093511702a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfd270>]}
[0m11:54:22.787480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e5172cd-90f7-4839-8704-a7093511702a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4b880>]}
[0m11:54:22.787805 [debug] [MainThread]: Acquiring new bigquery connection "macro_generate_source"
[0m11:54:22.804249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:22.805302 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `dbt-practice-355719`.raw_data.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m11:54:24.477908 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-practice-355719&j=bq:03c7f74e-b291-4cf0-9921-f11d64f2bdc4:US&page=queryresults
[0m11:54:24.479003 [info ] [MainThread]: version: 2

sources:
  - name: raw_data
    tables:
      - name: transactions
[0m11:54:24.480440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a87370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e235b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e23fd0>]}
[0m11:54:24.481004 [debug] [MainThread]: Flushing usage events
[0m11:54:24.665867 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.


============================== 2022-10-21 13:24:05.293652 | 5a772a7e-8b6e-4440-8f37-ad47b4be2b4a ==============================
[0m13:24:05.293674 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:24:05.294313 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:24:05.294391 [debug] [MainThread]: Tracking: tracking
[0m13:24:05.305946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107707610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077078e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077074c0>]}
[0m13:24:05.332552 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:24:05.332760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a772a7e-8b6e-4440-8f37-ad47b4be2b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ea7a0>]}
[0m13:24:05.356041 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
[0m13:24:05.357152 [debug] [MainThread]: Parsing macros/etc.sql
[0m13:24:05.357950 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:24:05.361078 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:24:05.370243 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m13:24:05.371257 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m13:24:05.372412 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m13:24:05.375754 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m13:24:05.376870 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m13:24:05.384357 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m13:24:05.385007 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:24:05.385151 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:24:05.385402 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m13:24:05.385832 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:24:05.385975 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:24:05.386202 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:24:05.386455 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:24:05.386849 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:24:05.387342 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:24:05.387543 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:24:05.387738 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:24:05.387943 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:24:05.388143 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:24:05.388317 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:24:05.388931 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:24:05.389145 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:24:05.389463 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:24:05.389700 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:24:05.390744 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:24:05.392280 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:24:05.393178 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:24:05.393853 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:24:05.400668 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:24:05.406542 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:24:05.412090 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:24:05.414002 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:24:05.414719 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:24:05.415434 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:24:05.418763 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:24:05.425664 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:24:05.426272 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:24:05.429016 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:24:05.433429 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:24:05.441002 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:24:05.443315 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:24:05.444715 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:24:05.447121 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:24:05.447665 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:24:05.449064 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:24:05.449975 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:24:05.452949 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:24:05.460994 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:24:05.461613 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:24:05.462612 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:24:05.463230 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:24:05.463593 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:24:05.463905 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:24:05.464172 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:24:05.464718 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:24:05.466902 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:24:05.470455 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:24:05.470789 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:24:05.471270 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:24:05.471641 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:24:05.472017 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:24:05.472530 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:24:05.472858 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:24:05.473265 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:24:05.473746 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:24:05.474697 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:24:05.475188 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:24:05.475615 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:24:05.476028 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:24:05.476437 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:24:05.476795 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:24:05.477212 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:24:05.477562 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:24:05.480280 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:24:05.480695 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:24:05.481057 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:24:05.481776 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:24:05.482680 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:24:05.483083 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:24:05.483672 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:24:05.484084 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:24:05.484928 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:24:05.486249 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:24:05.487369 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:24:05.493653 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:24:05.494454 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:24:05.500087 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:24:05.501868 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:24:05.504842 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:24:05.509041 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:24:05.511627 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:24:05.512860 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m13:24:05.514023 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m13:24:05.515579 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m13:24:05.516413 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m13:24:05.517593 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m13:24:05.518581 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
[0m13:24:05.519099 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
[0m13:24:05.519726 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
[0m13:24:05.520257 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
[0m13:24:05.523085 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
[0m13:24:05.523621 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
[0m13:24:05.524254 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
[0m13:24:05.524763 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
[0m13:24:05.525324 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
[0m13:24:05.525918 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
[0m13:24:05.526656 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
[0m13:24:05.527279 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
[0m13:24:05.527876 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
[0m13:24:05.528469 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
[0m13:24:05.528983 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
[0m13:24:05.529620 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
[0m13:24:05.530153 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
[0m13:24:05.530728 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
[0m13:24:05.531255 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
[0m13:24:05.531792 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
[0m13:24:05.532437 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
[0m13:24:05.533024 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
[0m13:24:05.533716 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
[0m13:24:05.534290 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m13:24:05.545769 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m13:24:05.546525 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m13:24:05.547499 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m13:24:05.548091 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m13:24:05.548836 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m13:24:05.549511 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m13:24:05.550449 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m13:24:05.551132 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m13:24:05.551623 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m13:24:05.552679 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m13:24:05.553547 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m13:24:05.554111 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m13:24:05.554607 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m13:24:05.555760 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m13:24:05.556594 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m13:24:05.557315 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m13:24:05.558198 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m13:24:05.559409 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m13:24:05.559972 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m13:24:05.561434 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m13:24:05.565849 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m13:24:05.566281 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m13:24:05.566720 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m13:24:05.567191 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m13:24:05.567616 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m13:24:05.568069 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m13:24:05.568846 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m13:24:05.570616 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m13:24:05.571243 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m13:24:05.572653 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m13:24:05.574441 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m13:24:05.575831 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m13:24:05.576496 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m13:24:05.578077 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m13:24:05.581467 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m13:24:05.586755 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m13:24:05.587285 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m13:24:05.590357 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m13:24:05.591733 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m13:24:05.592369 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m13:24:05.593014 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m13:24:05.595954 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m13:24:05.598326 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m13:24:05.600059 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m13:24:05.601173 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m13:24:05.603430 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m13:24:05.604354 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m13:24:05.604991 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m13:24:05.608506 [debug] [MainThread]: Parsing macros/generate_model_import_ctes.sql
[0m13:24:05.618394 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m13:24:05.620960 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m13:24:05.622681 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m13:24:05.626531 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m13:24:05.839059 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
[0m13:24:05.888216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a772a7e-8b6e-4440-8f37-ad47b4be2b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796d630>]}
[0m13:24:05.892963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a772a7e-8b6e-4440-8f37-ad47b4be2b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107716aa0>]}
[0m13:24:05.893076 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 526 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m13:24:05.893188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a772a7e-8b6e-4440-8f37-ad47b4be2b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7f280>]}
[0m13:24:05.893685 [info ] [MainThread]: 
[0m13:24:05.893954 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:24:05.894305 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev"
[0m13:24:05.894379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:06.443955 [debug] [ThreadPool]: Acquiring new bigquery connection "create_dbt-practice-dev_staging"
[0m13:24:06.444813 [debug] [ThreadPool]: Acquiring new bigquery connection "create_dbt-practice-dev_staging"
[0m13:24:06.445110 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='dbt-practice-dev', schema='staging', identifier=None)"
[0m13:24:06.456864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:06.458369 [debug] [ThreadPool]: On create_dbt-practice-dev_staging: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "create_dbt-practice-dev_staging"} */
create schema if not exists `dbt-practice-dev`.`staging`
  
[0m13:24:08.033661 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-practice-dev&j=bq:4d2a6048-f60b-4b39-a609-8d01f3278d07:US&page=queryresults
[0m13:24:08.036943 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev_mapping"
[0m13:24:08.037732 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev_staging"
[0m13:24:08.038022 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:08.038278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:08.573603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a772a7e-8b6e-4440-8f37-ad47b4be2b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062da4a0>]}
[0m13:24:08.574851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:24:08.575202 [info ] [MainThread]: 
[0m13:24:08.581654 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
[0m13:24:08.582086 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_transactions_totals .................... [RUN]
[0m13:24:08.582787 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
[0m13:24:08.582959 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
[0m13:24:08.583130 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
[0m13:24:08.587193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
[0m13:24:08.588098 [debug] [Thread-1 (]: finished collecting timing info
[0m13:24:08.588245 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
[0m13:24:08.612010 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_practice.stg_transactions_totals"
[0m13:24:08.612679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:08.613556 [debug] [Thread-1 (]: On model.dbt_practice.stg_transactions_totals: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_practice", "target_name": "dev", "node_id": "model.dbt_practice.stg_transactions_totals"} */


  create or replace view `dbt-practice-dev`.`staging`.`stg_transactions_totals`
  OPTIONS()
  as WITH
cte_1 AS (
    SELECT * FROM  `dbt-practice-355719`.`raw_data`.`transactions`
    )

SELECT
    *,
    SAFE_MULTIPLY(QTY, `VALUE`) AS TOTAL_SALES
FROM cte_1;


[0m13:24:09.232283 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-practice-dev&j=bq:US:9f11f9b8-7a42-454f-900a-98f6034ca5f1&page=queryresults
[0m13:24:09.233971 [debug] [Thread-1 (]: finished collecting timing info
[0m13:24:09.234818 [debug] [Thread-1 (]: Database Error in model stg_transactions_totals (models/staging/stg_transactions_totals.sql)
  Access Denied: Table dbt-practice-355719:raw_data.transactions: User does not have permission to query table dbt-practice-355719:raw_data.transactions, or perhaps it does not exist in location US.
  compiled Code at target/run/dbt_practice/models/staging/stg_transactions_totals.sql
[0m13:24:09.235131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a772a7e-8b6e-4440-8f37-ad47b4be2b4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad5870>]}
[0m13:24:09.235582 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging.stg_transactions_totals ........... [[31mERROR[0m in 0.65s]
[0m13:24:09.236016 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
[0m13:24:09.237539 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:24:09.238115 [info ] [MainThread]: 
[0m13:24:09.238373 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m13:24:09.238591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:09.238701 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
[0m13:24:09.238810 [debug] [MainThread]: Connection 'list_dbt-practice-dev_staging' was properly closed.
[0m13:24:09.251822 [info ] [MainThread]: 
[0m13:24:09.252023 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:24:09.252181 [info ] [MainThread]: 
[0m13:24:09.252314 [error] [MainThread]: [33mDatabase Error in model stg_transactions_totals (models/staging/stg_transactions_totals.sql)[0m
[0m13:24:09.252441 [error] [MainThread]:   Access Denied: Table dbt-practice-355719:raw_data.transactions: User does not have permission to query table dbt-practice-355719:raw_data.transactions, or perhaps it does not exist in location US.
[0m13:24:09.252556 [error] [MainThread]:   compiled Code at target/run/dbt_practice/models/staging/stg_transactions_totals.sql
[0m13:24:09.252676 [info ] [MainThread]: 
[0m13:24:09.252807 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:24:09.253017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062da4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b53b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107913e80>]}
[0m13:24:09.253174 [debug] [MainThread]: Flushing usage events


============================== 2022-10-21 13:29:08.026725 | a831b51e-b23d-4c7d-b7c3-d23882d756e2 ==============================
[0m13:29:08.026761 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:29:08.027414 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:29:08.027494 [debug] [MainThread]: Tracking: tracking
[0m13:29:08.035635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774d540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774d5d0>]}
[0m13:29:08.085161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:29:08.085306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:29:08.088284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a831b51e-b23d-4c7d-b7c3-d23882d756e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f80d0>]}
[0m13:29:08.095297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a831b51e-b23d-4c7d-b7c3-d23882d756e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b2c50>]}
[0m13:29:08.095437 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 526 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m13:29:08.095561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a831b51e-b23d-4c7d-b7c3-d23882d756e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b3190>]}
[0m13:29:08.096267 [info ] [MainThread]: 
[0m13:29:08.096569 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:29:08.097000 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev"
[0m13:29:08.097121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:08.626809 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev_mapping"
[0m13:29:08.627630 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev_staging"
[0m13:29:08.627947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:29:08.628187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:09.159032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a831b51e-b23d-4c7d-b7c3-d23882d756e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106326530>]}
[0m13:29:09.160190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:29:09.160522 [info ] [MainThread]: 
[0m13:29:09.166846 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
[0m13:29:09.167249 [info ] [Thread-1 (]: 1 of 1 START sql view model staging.stg_transactions_totals .................... [RUN]
[0m13:29:09.167892 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
[0m13:29:09.168069 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
[0m13:29:09.168234 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
[0m13:29:09.172118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
[0m13:29:09.173089 [debug] [Thread-1 (]: finished collecting timing info
[0m13:29:09.173246 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
[0m13:29:09.197627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_practice.stg_transactions_totals"
[0m13:29:09.198235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:29:09.199060 [debug] [Thread-1 (]: On model.dbt_practice.stg_transactions_totals: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_practice", "target_name": "dev", "node_id": "model.dbt_practice.stg_transactions_totals"} */


  create or replace view `dbt-practice-dev`.`staging`.`stg_transactions_totals`
  OPTIONS()
  as WITH
cte_1 AS (
    SELECT * FROM  `dbt-practice-355719`.`raw_data`.`transactions`
    )

SELECT
    *,
    SAFE_MULTIPLY(QTY, `VALUE`) AS TOTAL_SALES
FROM cte_1;


[0m13:29:10.623203 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-practice-dev&j=bq:4285d9e0-c0f2-4e10-aafb-5708eea8fe96:US&page=queryresults
[0m13:29:10.640152 [debug] [Thread-1 (]: finished collecting timing info
[0m13:29:10.640755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a831b51e-b23d-4c7d-b7c3-d23882d756e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b0340>]}
[0m13:29:10.641103 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging.stg_transactions_totals ............... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m13:29:10.641464 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
[0m13:29:10.643012 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m13:29:10.643637 [info ] [MainThread]: 
[0m13:29:10.644007 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m13:29:10.644184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:10.644275 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
[0m13:29:10.644353 [debug] [MainThread]: Connection 'list_dbt-practice-dev_staging' was properly closed.
[0m13:29:10.663687 [info ] [MainThread]: 
[0m13:29:10.663926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:10.664095 [info ] [MainThread]: 
[0m13:29:10.664218 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:29:10.664509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079373d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107758970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6f010>]}
[0m13:29:10.664675 [debug] [MainThread]: Flushing usage events


============================== 2022-10-21 14:12:11.291470 | e749b630-b2e4-4ee0-8a47-468f454f93dd ==============================
[0m14:12:11.291517 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:12:11.292956 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m14:12:11.293366 [debug] [MainThread]: Tracking: tracking
[0m14:12:11.303759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1f4c0>]}
[0m14:12:11.356596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:11.356727 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:11.359613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e749b630-b2e4-4ee0-8a47-468f454f93dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cbf10>]}
[0m14:12:11.364704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e749b630-b2e4-4ee0-8a47-468f454f93dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718e7a0>]}
[0m14:12:11.364839 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 526 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m14:12:11.364953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e749b630-b2e4-4ee0-8a47-468f454f93dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8ccd0>]}
[0m14:12:11.365576 [info ] [MainThread]: 
[0m14:12:11.365862 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:12:11.366284 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev_staging"
[0m14:12:11.366515 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev_mapping"
[0m14:12:11.366612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:11.366684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:11.923318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e749b630-b2e4-4ee0-8a47-468f454f93dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718d870>]}
[0m14:12:11.924746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:11.925083 [info ] [MainThread]: 
[0m14:12:11.931486 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
[0m14:12:11.931712 [debug] [Thread-2 (]: Began running node seed.dbt_practice.months
[0m14:12:11.932270 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
[0m14:12:11.932764 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.dbt_practice.months"
[0m14:12:11.932927 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
[0m14:12:11.933037 [debug] [Thread-2 (]: Began compiling node seed.dbt_practice.months
[0m14:12:11.933184 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
[0m14:12:11.933450 [debug] [Thread-2 (]: Compiling seed.dbt_practice.months
[0m14:12:11.937485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
[0m14:12:11.939288 [debug] [Thread-2 (]: Writing injected SQL for node "seed.dbt_practice.months"
[0m14:12:11.939536 [debug] [Thread-2 (]: finished collecting timing info
[0m14:12:11.939673 [debug] [Thread-2 (]: Began executing node seed.dbt_practice.months
[0m14:12:11.939826 [debug] [Thread-2 (]: finished collecting timing info
[0m14:12:11.940374 [debug] [Thread-2 (]: Finished running node seed.dbt_practice.months
[0m14:12:11.940715 [debug] [Thread-1 (]: finished collecting timing info
[0m14:12:11.940832 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
[0m14:12:11.940926 [debug] [Thread-1 (]: finished collecting timing info
[0m14:12:11.941330 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
[0m14:12:11.942007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:11.942116 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
[0m14:12:11.942200 [debug] [MainThread]: Connection 'seed.dbt_practice.months' was properly closed.
[0m14:12:11.953685 [info ] [MainThread]: Done.
[0m14:12:11.955505 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m14:12:11.955620 [info ] [MainThread]: Building catalog
[0m14:12:11.955977 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:12.372199 [debug] [MainThread]: BigQuery adapter: Skipping catalog for dbt-practice-dev.mapping - schema does not exist
[0m14:12:12.578048 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-dev.information_schema"
[0m14:12:12.579127 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-355719.information_schema"
[0m14:12:12.599155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:12.601093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:12.602532 [debug] [ThreadPool]: On dbt-practice-355719.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-355719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-355719`.`raw_data`.__TABLES__
        where (upper(dataset_id) = upper('raw_data'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m14:12:12.603456 [debug] [ThreadPool]: On dbt-practice-dev.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-dev.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-dev`.`staging`.__TABLES__
        where (upper(dataset_id) = upper('staging'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-dev`.`staging`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-dev`.`staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m14:12:15.984697 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-practice-dev&j=bq:396b4653-721e-4736-9dee-08f737590513:US&page=queryresults
[0m14:12:16.005602 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-practice-dev&j=bq:9cf4f699-c09c-4dec-9382-e58a2129eedf:US&page=queryresults
[0m14:12:16.037465 [info ] [MainThread]: Catalog written to /Users/will/Projects/dbt-practice/target/catalog.json
[0m14:12:16.038002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107258370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072583a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725a470>]}
[0m14:12:16.038306 [debug] [MainThread]: Flushing usage events
[0m14:12:16.324775 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:12:16.325635 [debug] [MainThread]: Connection 'dbt-practice-dev.information_schema' was properly closed.
[0m14:12:16.326129 [debug] [MainThread]: Connection 'dbt-practice-355719.information_schema' was properly closed.


============================== 2022-10-21 14:19:08.016462 | c06904c4-76db-4b35-b5aa-25ba5b5903f3 ==============================
[0m14:19:08.016522 [info ] [MainThread]: Running with dbt=1.3.0
[0m14:19:08.017110 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/will/Projects/dbt-practice', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m14:19:08.017392 [debug] [MainThread]: Tracking: tracking
[0m14:19:08.028489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c34f0>]}
[0m14:19:08.043312 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
[0m14:19:08.043494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c06904c4-76db-4b35-b5aa-25ba5b5903f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d3490>]}
[0m14:19:08.066619 [debug] [MainThread]: Parsing macros/get_custom_schema.sql
[0m14:19:08.068223 [debug] [MainThread]: Parsing macros/etc.sql
[0m14:19:08.069069 [debug] [MainThread]: Parsing macros/catalog.sql
[0m14:19:08.072162 [debug] [MainThread]: Parsing macros/adapters.sql
[0m14:19:08.081321 [debug] [MainThread]: Parsing macros/materializations/seed.sql
[0m14:19:08.082371 [debug] [MainThread]: Parsing macros/materializations/view.sql
[0m14:19:08.083621 [debug] [MainThread]: Parsing macros/materializations/table.sql
[0m14:19:08.086910 [debug] [MainThread]: Parsing macros/materializations/copy.sql
[0m14:19:08.088033 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
[0m14:19:08.095559 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
[0m14:19:08.096237 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:19:08.096384 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:19:08.096642 [debug] [MainThread]: Parsing macros/utils/timestamps.sql
[0m14:19:08.097068 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:19:08.097209 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:19:08.097436 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:19:08.097691 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:19:08.098087 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:19:08.098582 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:19:08.098785 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:19:08.098981 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:19:08.099191 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:19:08.099394 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:19:08.099562 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:19:08.100166 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:19:08.100376 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:19:08.100693 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:19:08.100926 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:19:08.101971 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m14:19:08.103519 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m14:19:08.104433 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m14:19:08.105104 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m14:19:08.111936 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m14:19:08.117787 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m14:19:08.123109 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m14:19:08.124960 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m14:19:08.125673 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m14:19:08.126385 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m14:19:08.129706 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m14:19:08.136547 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m14:19:08.137149 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m14:19:08.139897 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m14:19:08.144321 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m14:19:08.151819 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m14:19:08.154136 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m14:19:08.155533 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m14:19:08.157864 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m14:19:08.158371 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m14:19:08.159748 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m14:19:08.160647 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m14:19:08.163575 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m14:19:08.171616 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m14:19:08.172208 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m14:19:08.173203 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m14:19:08.173824 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m14:19:08.174186 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m14:19:08.174496 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m14:19:08.174766 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m14:19:08.175308 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m14:19:08.177581 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m14:19:08.181082 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m14:19:08.181403 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m14:19:08.181886 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m14:19:08.182260 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m14:19:08.182627 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m14:19:08.183114 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m14:19:08.183433 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m14:19:08.183838 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m14:19:08.184325 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m14:19:08.185271 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m14:19:08.185756 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m14:19:08.186179 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m14:19:08.186595 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m14:19:08.187004 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m14:19:08.187371 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m14:19:08.187794 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m14:19:08.188147 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m14:19:08.190880 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m14:19:08.191304 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m14:19:08.191662 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m14:19:08.192371 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m14:19:08.193269 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m14:19:08.193671 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m14:19:08.194265 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m14:19:08.194680 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m14:19:08.195520 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m14:19:08.196846 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m14:19:08.197965 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m14:19:08.204246 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m14:19:08.205039 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m14:19:08.210659 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m14:19:08.212445 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m14:19:08.215419 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m14:19:08.219659 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m14:19:08.222327 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m14:19:08.223563 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m14:19:08.224747 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m14:19:08.226324 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m14:19:08.227161 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m14:19:08.228359 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m14:19:08.229362 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
[0m14:19:08.229879 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
[0m14:19:08.230504 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
[0m14:19:08.231059 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
[0m14:19:08.233896 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
[0m14:19:08.234440 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
[0m14:19:08.235076 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
[0m14:19:08.235592 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
[0m14:19:08.236148 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
[0m14:19:08.236742 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
[0m14:19:08.237479 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
[0m14:19:08.238105 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
[0m14:19:08.238703 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
[0m14:19:08.239290 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
[0m14:19:08.239802 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
[0m14:19:08.240441 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
[0m14:19:08.240978 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
[0m14:19:08.241557 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
[0m14:19:08.242094 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
[0m14:19:08.242631 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
[0m14:19:08.243271 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
[0m14:19:08.243867 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
[0m14:19:08.244692 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
[0m14:19:08.245267 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m14:19:08.256535 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m14:19:08.257312 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m14:19:08.258317 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m14:19:08.258933 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m14:19:08.259678 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m14:19:08.260355 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m14:19:08.261290 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m14:19:08.261969 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m14:19:08.262458 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m14:19:08.263519 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m14:19:08.264381 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m14:19:08.264942 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m14:19:08.265443 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m14:19:08.266604 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m14:19:08.267457 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m14:19:08.268181 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m14:19:08.269076 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m14:19:08.270279 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m14:19:08.270844 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m14:19:08.272314 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m14:19:08.276681 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m14:19:08.277115 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m14:19:08.277553 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m14:19:08.278022 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m14:19:08.278449 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m14:19:08.278908 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m14:19:08.279677 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m14:19:08.281439 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m14:19:08.282079 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m14:19:08.283455 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m14:19:08.285209 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m14:19:08.286592 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m14:19:08.287256 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m14:19:08.288843 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m14:19:08.292171 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m14:19:08.297302 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m14:19:08.297831 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m14:19:08.300892 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m14:19:08.302274 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m14:19:08.302918 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m14:19:08.303564 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m14:19:08.306482 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m14:19:08.308820 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m14:19:08.310525 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m14:19:08.311627 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m14:19:08.313866 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m14:19:08.314782 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m14:19:08.315415 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m14:19:08.317943 [debug] [MainThread]: Parsing macros/generate_model_import_ctes.sql
[0m14:19:08.328414 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
[0m14:19:08.330971 [debug] [MainThread]: Parsing macros/generate_base_model.sql
[0m14:19:08.332661 [debug] [MainThread]: Parsing macros/generate_source.sql
[0m14:19:08.336487 [debug] [MainThread]: Parsing macros/helpers/helpers.sql
[0m14:19:08.518476 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_transactions_totals.sql
[0m14:19:08.598570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c06904c4-76db-4b35-b5aa-25ba5b5903f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592be80>]}
[0m14:19:08.603113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c06904c4-76db-4b35-b5aa-25ba5b5903f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d0ca0>]}
[0m14:19:08.603234 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 526 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
[0m14:19:08.603336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06904c4-76db-4b35-b5aa-25ba5b5903f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a7040>]}
[0m14:19:08.603850 [info ] [MainThread]: 
[0m14:19:08.604122 [debug] [MainThread]: Acquiring new bigquery connection "master"
[0m14:19:08.604492 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev_staging"
[0m14:19:08.604557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:08.604866 [debug] [ThreadPool]: Acquiring new bigquery connection "list_dbt-practice-dev_mapping"
[0m14:19:08.604942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:09.217798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06904c4-76db-4b35-b5aa-25ba5b5903f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592a1a0>]}
[0m14:19:09.219235 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:19:09.219582 [info ] [MainThread]: 
[0m14:19:09.225873 [debug] [Thread-1 (]: Began running node model.dbt_practice.stg_transactions_totals
[0m14:19:09.226046 [debug] [Thread-2 (]: Began running node seed.dbt_practice.months
[0m14:19:09.226617 [debug] [Thread-1 (]: Acquiring new bigquery connection "model.dbt_practice.stg_transactions_totals"
[0m14:19:09.227090 [debug] [Thread-2 (]: Acquiring new bigquery connection "seed.dbt_practice.months"
[0m14:19:09.227248 [debug] [Thread-1 (]: Began compiling node model.dbt_practice.stg_transactions_totals
[0m14:19:09.227407 [debug] [Thread-2 (]: Began compiling node seed.dbt_practice.months
[0m14:19:09.227591 [debug] [Thread-1 (]: Compiling model.dbt_practice.stg_transactions_totals
[0m14:19:09.227714 [debug] [Thread-2 (]: Compiling seed.dbt_practice.months
[0m14:19:09.231650 [debug] [Thread-2 (]: Writing injected SQL for node "seed.dbt_practice.months"
[0m14:19:09.232831 [debug] [Thread-2 (]: finished collecting timing info
[0m14:19:09.233965 [debug] [Thread-2 (]: Began executing node seed.dbt_practice.months
[0m14:19:09.234342 [debug] [Thread-2 (]: finished collecting timing info
[0m14:19:09.234902 [debug] [Thread-2 (]: Finished running node seed.dbt_practice.months
[0m14:19:09.239628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_practice.stg_transactions_totals"
[0m14:19:09.240732 [debug] [Thread-1 (]: finished collecting timing info
[0m14:19:09.240945 [debug] [Thread-1 (]: Began executing node model.dbt_practice.stg_transactions_totals
[0m14:19:09.241062 [debug] [Thread-1 (]: finished collecting timing info
[0m14:19:09.241655 [debug] [Thread-1 (]: Finished running node model.dbt_practice.stg_transactions_totals
[0m14:19:09.242496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:09.242595 [debug] [MainThread]: Connection 'model.dbt_practice.stg_transactions_totals' was properly closed.
[0m14:19:09.242669 [debug] [MainThread]: Connection 'seed.dbt_practice.months' was properly closed.
[0m14:19:09.249243 [info ] [MainThread]: Done.
[0m14:19:09.251166 [debug] [MainThread]: Acquiring new bigquery connection "generate_catalog"
[0m14:19:09.251372 [info ] [MainThread]: Building catalog
[0m14:19:09.251751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:09.758204 [debug] [MainThread]: BigQuery adapter: Skipping catalog for dbt-practice-dev.mapping - schema does not exist
[0m14:19:09.989513 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-dev.information_schema"
[0m14:19:09.990345 [debug] [ThreadPool]: Acquiring new bigquery connection "dbt-practice-355719.information_schema"
[0m14:19:10.008434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:10.010445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:10.012652 [debug] [ThreadPool]: On dbt-practice-355719.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-355719.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-355719`.`raw_data`.__TABLES__
        where (upper(dataset_id) = upper('raw_data'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-355719`.`raw_data`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m14:19:10.012802 [debug] [ThreadPool]: On dbt-practice-dev.information_schema: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "dbt_practice", "target_name": "dev", "connection_name": "dbt-practice-dev.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbt-practice-dev`.`staging`.__TABLES__
        where (upper(dataset_id) = upper('staging'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbt-practice-dev`.`staging`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbt-practice-dev`.`staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m14:19:12.959527 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-practice-dev&j=bq:eced1f5c-28c4-407d-95f2-74d9579f2185:US&page=queryresults
[0m14:19:13.857414 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-practice-dev&j=bq:73c1dab3-9e34-4601-9e9c-0d86a4cd0ac1:US&page=queryresults
[0m14:19:13.881965 [info ] [MainThread]: Catalog written to /Users/will/Projects/dbt-practice/docs/catalog.json
[0m14:19:13.882514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10436bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a2eaa0>]}
[0m14:19:13.882948 [debug] [MainThread]: Flushing usage events
[0m14:19:14.131469 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:19:14.131981 [debug] [MainThread]: Connection 'dbt-practice-dev.information_schema' was properly closed.
[0m14:19:14.132238 [debug] [MainThread]: Connection 'dbt-practice-355719.information_schema' was properly closed.
